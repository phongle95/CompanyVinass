/*
  filename: integralui.grid.js
  version : 1.4.0
  Copyright Â© 2016-2018 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(l,b){function a(){this.constructor=l}for(var c in b)b.hasOwnProperty(c)&&(l[c]=b[c]);l.prototype=null===b?Object.create(b):(a.prototype=b.prototype,new a)},__decorate=this&&this.__decorate||function(l,b,a,c){var d=arguments.length,e=3>d?b:null===c?c=Object.getOwnPropertyDescriptor(b,a):c,h;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)e=Reflect.decorate(l,b,a,c);else for(var f=l.length-1;0<=f;f--)if(h=l[f])e=(3>d?h(e):3<d?h(b,a,e):
h(b,a))||e;return 3<d&&e&&Object.defineProperty(b,a,e),e},__metadata=this&&this.__metadata||function(l,b){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(l,b)},core_1=require("@angular/core"),integralui_core_1=require("./integralui.core"),integralui_base_grid_1=require("./integralui.base.grid"),integralui_common_service_1=require("../services/integralui.common.service"),integralui_data_service_1=require("../services/integralui.data.service"),integralui_dragdrop_service_1=
require("../services/integralui.dragdrop.service"),integralui_filter_service_1=require("../services/integralui.filter.service"),integralui_scrollbar_1=require("./integralui.scrollbar"),IntegralUIGrid=function(l){function b(a,c,d,b,h,f,g,k){var e=l.call(this,a,c,d,b,h,f)||this;e.dataService=a;e.dragDropService=c;e.elemRef=d;e.elemRenderer=b;e.commonService=h;e.filterService=f;e.cmpResolver=g;e.baseService=k;e.headerData=[];e.rowData=[];e.cellData=[];e.footerData=[];e.fullList=[];e.expandTimeout=null;
e.expandRow=null;e.horScrollOrientation=integralui_core_1.IntegralUIOrientation.Horizontal;e.isGroupPanelHovered=!1;e.isThereChildRows=!1;e.dataGroups=[];e.groupList=[];e.activeGroups=[];e.groupExpandList=[];e.isGroupListItemSelected=!1;e.groupPanelSize={width:0,height:0};e.groupPanelHeight=0;e.dragGroupSettings={display:"none",top:0,left:0,label:""};e.groupReorderMargin=50;e.reorderGroupWidth=50;e.blockMarginTop=0;e.blockSize={width:0,height:0};e.updateTimer=null;e.templateList=[];e.gridCursor="default";
e.refreshTimer=null;e.trialRef=null;e.autoExpand=!1;e.afterCollapse=new core_1.EventEmitter;e.afterExpand=new core_1.EventEmitter;e.beforeCollapse=new core_1.EventEmitter;e.beforeExpand=new core_1.EventEmitter;e.groupAdding=new core_1.EventEmitter;e.groupAdded=new core_1.EventEmitter;e.groupRemoving=new core_1.EventEmitter;e.groupRemoved=new core_1.EventEmitter;e.groupOrderChanged=new core_1.EventEmitter;e.groupReorderActive=!1;e.hoverGroup=null;e.reorderGroup=null;e.dragGroupElemSize={width:0,height:0};
e.groupCoordinates=[];e.reorderGroupPos=-1;e.updateGrouping(e.grouping);return e}__extends(b,l);Object.defineProperty(b.prototype,"expandColumnIndex",{get:function(){return this.expandColIndex},set:function(a){this.expandColIndex!=a&&(this.expandColIndex=a,this.updateLayout())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"expandColumnID",{get:function(){return this.currentExpandColumnID},set:function(a){this.currentExpandColumnID!=a&&(this.currentExpandColumnID=a,this.updateLayout())},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"grouping",{get:function(){return this.options.grouping},set:function(a){this.updateGrouping(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"groups",{get:function(){return this.dataGroups},set:function(a){this.dataGroups=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"indent",{get:function(){return this.options.indent},set:function(a){this.options.indent!=a&&(this.options.indent=a,this.updateLayout())},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"showHeader",{get:function(){return this.isHeaderVisible},set:function(a){this.isHeaderVisible!=a&&(this.isHeaderVisible=a,this.updateLayout())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"showFooter",{get:function(){return this.isFooterVisible},set:function(a){this.isFooterVisible!=a&&(this.isFooterVisible=a,this.updateLayout())},enumerable:!0,configurable:!0});b.prototype.ngOnInit=function(){this.baseService.setComponent(this);
this.updateData();this.generalClassName="iui-grid";this.columnClassName=this.generalClassName+"-column";this.columnHeaderClassName=this.columnClassName+"-header";this.columnBodyClassName=this.columnClassName+"-body";this.columnFooterClassName=this.columnClassName+"-footer";this.rowClassName=this.generalClassName+"-row";this.cellBorderClassName="iui-grid-lines-both";this.cellClassName=this.rowClassName+"-cell";this.expandBoxClassName=this.generalClassName+"-expand-box";this.gridLinesClassName=this.generalClassName+
"-lines";this.sortingClassName="iui-sort";this.initStyle()};b.prototype.updateData=function(){this.dataService.init([{data:this.columns,fields:this.options.columnFields,key:this.columnDataKey},{data:this.rows,fields:this.options.rowFields,key:this.rowDataKey}])};b.prototype.initStyle=function(){this.defaultStyle={general:{disabled:this.generalClassName+"-disabled",focused:this.generalClassName+"-focused",normal:this.generalClassName,hovered:this.generalClassName+"-hovered",selected:this.generalClassName+
"-selected"},column:{header:{cell:this.columnHeaderClassName+"-cell",disabled:this.columnHeaderClassName+"-disabled",normal:this.columnHeaderClassName,hovered:this.columnHeaderClassName+"-hovered",selected:this.columnHeaderClassName+"-selected"},body:{cell:this.columnBodyClassName+"-cell",disabled:this.columnBodyClassName+"-disabled",normal:this.columnBodyClassName,hovered:this.columnBodyClassName+"-hovered",selected:this.columnBodyClassName+"-selected"},footer:{cell:this.columnFooterClassName+"-cell",
disabled:this.columnFooterClassName+"-disabled",normal:this.columnFooterClassName,hovered:this.columnFooterClassName+"-hovered",selected:this.columnFooterClassName+"-selected"},sorting:{normal:{ascending:this.sortingClassName+"-ascending",descending:this.sortingClassName+"-descending"},selected:{ascending:this.sortingClassName+"-ascending-selected",descending:this.sortingClassName+"-descending-selected"}}},row:{general:{disabled:this.rowClassName+"-disabled",focused:this.rowClassName+"-focused",normal:this.rowClassName,
hovered:this.rowClassName+"-hovered",selected:this.rowClassName+"-selected"},expandBox:{general:this.expandBoxClassName,load:this.expandBoxClassName+"-load",expanded:this.expandBoxClassName+"-open",collapsed:this.expandBoxClassName+"-close"},cell:{disabled:this.cellClassName+"-disabled",focused:this.cellClassName+"-focused",normal:this.cellClassName,hovered:this.cellClassName+"-hovered",selected:this.cellClassName+"-selected"}},gridLines:{none:this.gridLinesClassName+"-none",horizontal:this.gridLinesClassName+
"-horizontal",vertical:this.gridLinesClassName+"-vertical",both:this.gridLinesClassName+"-both"}};this.updateStyle(this.controlStyle);this.refresh()};b.prototype.ngAfterViewInit=function(){var a=this,c=setTimeout(function(){var d=a.cmpResolver.resolveComponentFactory(integralui_core_1.IntegralUITComponent);d&&a.contentRef&&(a.trialRef=a.contentRef.createComponent(d));clearTimeout(c)},100);a.updateLayout()};b.prototype.ngAfterContentInit=function(){this.templateList=this.templates.toArray();for(var a=
0;a<this.templateList.length;a++)if(this.templateList[a].settings)switch(this.templateList[a].settings.type){case "header":this.headerData.push(this.templateList[a].getTemplate());break;case "row":this.rowData.push(this.templateList[a].getTemplate());break;case "cell":this.cellData.push(this.templateList[a].getTemplate());break;case "footer":this.footerData.push(this.templateList[a].getTemplate())}};b.prototype.ngOnDestroy=function(){this.expandTimeout&&clearTimeout(this.expandTimeout);this.removeDropMark();
this.trialRef&&this.trialRef.destroy()};b.prototype.ngAfterContentChecked=function(){1==this.autoUpdate&&(this.groupPanelHeight=this.groupingPanelElem?this.groupingPanelElem.nativeElement.offsetHeight:0,this.groupPanelSize.height=this.groupingPanelElem?this.groupingPanelElem.nativeElement.offsetHeight:0,this.paginatorHeight=this.paginatorElem?this.paginatorElem.nativeElement.offsetHeight:0,this.paginatorPos.top=this.elemRef.nativeElement.firstElementChild.clientHeight-this.paginatorHeight+1,this.horScrollElemPos.bottom=
0<this.paginatorHeight?this.paginatorHeight-1:0,this.cornerScrollElemPos.bottom=0<this.paginatorHeight?this.paginatorHeight-1:0,this.clientRect={width:this.elemRef.nativeElement.firstElementChild.clientWidth,height:this.elemRef.nativeElement.firstElementChild.clientHeight-this.groupPanelHeight-this.paginatorHeight},this.clientRect.width!=this.prevClientRect.width?(this.updateLayout(),this.prevClientRect.width=this.clientRect.width):this.clientRect.height!=this.prevClientRect.height&&(this.updateLayout(),
this.prevClientRect.height=this.clientRect.height))};b.prototype.updateDataFields=function(a){a?(this.updateColumnFields(a.column),this.updateGroupFields(a.group),this.updateRowFields(a.row),this.updateCellFields(a.cell)):(this.updateColumnFields(),this.updateGroupFields(),this.updateRowFields(),this.updateCellFields())};b.prototype.updateGroupFields=function(a){this.options.groupFields=a?{id:a.id?a.id:"id",cells:a.cells?a.cells:"cells",cid:a.cid?a.cid:"cid",expanded:a.expanded?a.expanded:"expanded",
rows:a.rows?a.rows:"rows",text:a.text?a.text:"text"}:{id:"id",cid:"cid",cells:"cells",expanded:"expanded",rows:"rows",text:"text"}};b.prototype.updateScrollColumnList=function(){this.scrollColumnList.length=0;for(var a=this.viewIndexRange.left;a<this.currentColumnList.length&&a<=this.viewIndexRange.right;a++){var c=this.currentColumnList[a];c={data:c.data,inlineStyle:this.getColumnInlineStyle(c.data[this.options.columnFields.style]),location:{top:0,left:0},position:"relative",style:{}};this.updateColumnStyle(c);
this.scrollColumnList.push(c)}};b.prototype.updateScrollRowList=function(){for(var a=this.scrollRowList.length=0,c=this.currentIndex;c<this.currentRowList.length&&c<this.currentIndex+this.visibleRange;c++){var d=this.currentRowList[c];d={cells:[],data:d.data,draggable:this.isEnabled&&"group"!=d.data.type?!0:!1,indent:d.indent,inlineStyle:d.data[this.options.rowFields.style],style:{}};this.updateRowStyle(d);for(var e=d.data[this.options.rowFields.cells],b=this.viewIndexRange.left;b<this.currentColumnList.length&&
b<=this.viewIndexRange.right;b++){var f=this.currentColumnList[b].data,g=b,k=f[this.options.columnFields.id];k&&(g=this.getCellIndexById(e,b,k));a++;g=0<=g&&g<e.length?e[g]:{};f={align:this.getCellAlignment(f),colIndex:b-this.viewIndexRange.left,data:g,expandBoxAllowed:this.isExpandBoxAllowed(f),indent:this.getRowIndent(d,f),inlineStyle:g&&g[this.options.cellFields.style]?g[this.options.cellFields.style]:"",rowIndex:c-this.currentIndex,style:{content:"iui-grid-row-cell-content"},tabIndex:a,width:this.getCellWidth(d,
f),height:0<this.rowHeight?this.rowHeight+"px":"auto"};d.cells.push(f)}this.scrollRowList.push(d)}};b.prototype.addColumnToCurrentList=function(a){if(this.isColumnVisible(a)&&(a.type="column",a[this.options.columnFields.id]||(a[this.options.columnFields.id]=this.commonService.getUniqueId()),0!=a[this.options.columnFields.visible])){var c=a[this.options.columnFields.filterParams];c=c?this.filterService.createTree(c.conditions,c.formula):null;this.currentColumnList.push({data:a,filter:c})}};b.prototype.updateCurrentColumnList=
function(){this.currentColumnList.length=0;var a=this.dataService.getList(null,this.columnDataKey);if(a)for(var c=0;c<a.length;c++)this.addColumnToCurrentList(a[c])};b.prototype.getGroup=function(a,c){var d=null,e=this.groupList;c&&(e=c[this.options.rowFields.rows]);if(e)for(var b=0;b<e.length;b++)if(e[b][this.options.rowFields.text]==a){d=e[b];break}return d};b.prototype.addRowToGroup=function(a){var c=a[this.options.rowFields.cells];if(c&&0<c.length){for(var d,e=null,b=0;b<this.groups.length;b++){d=
this.groups[b][this.options.groupFields.cid];var f=b;d&&(f=this.getCellIndexById(c,b,d));if(0<=f&&f<c.length){d=c[f][this.options.cellFields.text];if(!d||""==d){var g=c[f][this.options.cellFields.value];void 0!=g?(d=g.toString(),Array.isArray(g)&&0==g.length?d="undefined":0==g&&(d="undefined")):d="undefined"}g=c[f][this.options.cellFields.value];var k=this.getGroup(d,e);if(!k){k={};k[this.options.rowFields.text]=d;k[this.options.rowFields.gid]=this.groups[b][this.options.groupFields.id];var l=this.getExpandingColumn();
l&&(k[this.options.rowFields.cells]=[{cid:l[this.options.columnFields.id],text:d,isGroup:!0,tag:c[f][this.options.cellFields.tag],value:g,valueID:c[f][this.options.cellFields.cid]}],k.type="group",e?(k[this.options.rowFields.id]=e[this.options.rowFields.id]+"_"+k[this.options.rowFields.text],e[this.options.rowFields.rows]||(e[this.options.rowFields.rows]=[]),e[this.options.rowFields.rows].push(k)):(k[this.options.rowFields.id]="GRP_"+k[this.options.rowFields.text],this.groupList.push(k)),k[this.options.rowFields.expanded]=
this.isGroupExpandedFromRow(k))}e=k}}e&&(e[this.options.rowFields.rows]||(e[this.options.rowFields.rows]=[]),e[this.options.rowFields.rows].push(a))}};b.prototype.updateGroupList=function(){this.groupList.length=0;this.activeGroups.length=0;if(0<this.groups.length){for(var a=0;a<this.groups.length;a++)this.groups[a][this.options.groupFields.id]||(this.groups[a][this.options.groupFields.id]=this.commonService.getUniqueId()),this.activeGroups.push(this.groups[a]);var c=this.dataService.getList(null,
this.rowDataKey);if(c)for(a=0;a<c.length;a++)this.addRowToGroup(c[a])}this.createGroupExpandList()};b.prototype.createGroupExpandList=function(){this.groupExpandList.length=0;for(var a=this.getFullList(),c=0;c<a.length;c++)"group"==a[c].type&&this.groupExpandList.push({id:a[c][this.options.rowFields.id],expanded:this.isRowExpanded(a[c])})};b.prototype.updateExpandStatus=function(){this.createGroupExpandList()};b.prototype.updateGrouping=function(a){this.options.grouping=a?{dropdown:{appRef:this.isEnabled?
this.appRef:null,items:this.commonService.isFieldAvailable(a.items,[])},enabled:this.commonService.isFieldAvailable(a.enabled,!1),showAddButton:this.commonService.isFieldAvailable(a.showAddButton,!1),showColumns:this.commonService.isFieldAvailable(a.showColumns,!1),showPanel:this.commonService.isFieldAvailable(a.showPanel,!0)}:{dropdown:{appRef:this.appRef,items:[]},enabled:!1,showAddButton:!1,showColumns:!1,showPanel:!0}};b.prototype.getGroupExpandObj=function(a){return this.commonService.getObjFromListById(this.groupExpandList,
a)};b.prototype.updateGroupExpandValue=function(a,c){var d=this.commonService.getObjFromListById(this.groupExpandList,a);d&&(d.expanded=c)};b.prototype.updateCurrentRowList=function(){this.currentRowList.length=0;if(this.options.paging.enabled){if(1<=this.currentPageNumber&&this.currentPageNumber<=this.pageList.length)for(var a=0;a<this.pageList[this.currentPageNumber-1].length;a++)this.currentRowList.push(this.pageList[this.currentPageNumber-1][a])}else{this.isThereChildRows=!1;var c=this.dataService.getList(null,
this.rowDataKey);0<this.groups.length&&(c=this.groupList);if(c)for(this.applySorting(c),a=0;a<c.length;a++)this.addChildRows(c[a],0,null,!1)}};b.prototype.updatePageList=function(){this.pageNumber=0;this.pageRowCount=this.pageList.length=0;this.isThereChildRows=!1;var a=this.dataService.getList(null,this.rowDataKey);0<this.groups.length&&(a=this.groupList);if(a&&0<a.length){this.applySorting(a);this.pageList.push([]);for(var c=0;c<a.length;c++)this.addChildRows(a[c],0,null,!1);0<this.pageList.length&&
0==this.pageList[this.pageList.length-1].length&&this.pageList.splice(this.pageList.length-1,1)}};b.prototype.addChildRows=function(a,c,d,e){if(!a[this.options.rowFields.rows])return d=this.addRowToCurrentList(a,c,d,e);if(d=this.addRowToCurrentList(a,c,d,e)){var b=0,f;if("group"==a.type&&(e||this.isRowExpanded(a))||1==a[this.options.rowFields.hasChildren]&&(e||this.isRowExpanded(a))){var g=a[this.options.rowFields.rows];if(g){this.applySorting(g);for(var k=0;k<g.length;k++)(f=this.addChildRows(g[k],
c+this.options.indent,a[this.options.rowFields.id],e))&&b++}}e||this.isThereChildRows||!(0<b||!this.isRowExpanded(a)&&a[this.options.rowFields.rows]&&0<a[this.options.rowFields.rows].length&&this.isThereVisibleChildren(a))||(this.isThereChildRows=!0)}return d};b.prototype.addRowToCurrentList=function(a,c,d,e){a.type||(a.type="row");a[this.options.rowFields.id]||(a[this.options.rowFields.id]=this.commonService.getUniqueId());d&&(a[this.options.rowFields.pid]=d);d=!0;var b=a[this.options.rowFields.cells];
if(b&&0<b.length){d=this.isRowAllowed(a,e);for(var f,g=0;g<this.currentColumnList.length;g++){f=this.currentColumnList[g].data;f=f[this.options.columnFields.id];var k=g;f&&(k=this.getCellIndexById(b,g,f));0<=k&&k<b.length&&(b[k].type="cell",b[k][this.options.cellFields.rid]=a[this.options.rowFields.id])}}d&&(e?this.fullList.push(a):this.options.paging.enabled?this.onlyCurrentPage?this.currentPageList.push({data:a,indent:c}):(a[this.options.rowFields.pid]||this.pageRowCount++,this.pageRowCount>this.options.paging.pageSize&&
(this.pageRowCount=1,this.pageNumber++,this.pageList.push([])),this.pageList[this.pageNumber].push({data:a,indent:c})):this.currentRowList.push({data:a,indent:c}));return d};b.prototype.getFullList=function(){this.fullList.length=0;var a=this.dataService.getList(null,this.rowDataKey);0<this.groups.length&&(a=this.groupList);if(a)for(var c=0;c<a.length;c++)this.addChildRows(a[c],0,null,!0);return this.fullList};b.prototype.updateFullList=function(){this.getFullList()};b.prototype.loadData=function(a,
c,d,e){this.processLoadData(a,c,d,e)};b.prototype.expandOnDelay=function(a){var c=this;0!=c.autoExpand&&(c.expandRow!=a&&(c.expandTimeout&&clearTimeout(c.expandTimeout),c.expandTimeout=setTimeout(function(){c.expandTimeout&&c.expand(a);clearTimeout(c.expandTimeout)},500)),c.expandRow=a)};b.prototype.rowDragStart=function(a,c){this.isEnabled&&this.processDragStart(a,c.data);a.stopPropagation()};b.prototype.rowDragOver=function(a,c,d){if(this.isEnabled&&this.rowElems){var e=this.rowElems.toArray();
e&&0<=d&&d<e.length&&(d=this.commonService.getPageRect(e[d].nativeElement),d={x:d.left,y:d.top,width:d.right-d.left,height:d.bottom-d.top},this.expandOnDelay(c.data),this.processScroll(a,this.groupPanelHeight,this.paginatorHeight),this.processDragOver(a,c.data,d,!0))}a.stopPropagation()};b.prototype.rowDragDrop=function(a,c){this.isEnabled&&(this.expandRow=null,this.expandTimeout&&clearTimeout(this.expandTimeout),this.processDragDrop(a,c.data));a.stopPropagation()};b.prototype.isParentOf=function(a,
c){var d=this.dataService.getParent(c);return a&&c&&d&&this.commonService.isEqual(a[this.options.rowFields.id],d[this.options.rowFields.id])?!0:!1};b.prototype.isChildOf=function(a,c){var d=!1;if(a&&c){var e=c[this.options.rowFields.rows];if(e&&0<e.length)for(var b=0;b<e.length;b++){if(this.commonService.isEqual(a[this.options.rowFields.id],e[b][this.options.rowFields.id])){d=!0;break}else d=this.isChildOf(a,e[b]);if(d)break}}return d};b.prototype.processDataDrop=function(a,c,d){var b=a.shiftKey;
!a.shiftKey&&d.sourceCtrl&&d.sourceCtrl.removeRow&&(b=d.sourceCtrl.removeRow(c));if(b)switch(d.dropPos){case 0:d.target&&"group"==d.target.type&&(this.processDataDropAtTargetGroup(c,d.target),this.addRow(c));break;case 1:this.processDataDropAtTargetRow(c,d.target,d.dropPos);break;case 2:this.processDataDropAtTargetRow(c,d.target,d.dropPos);break;default:this.addRow(c)}};b.prototype.processDataDropAtTargetGroup=function(a,c){var d=c[this.options.rowFields.cells];if(a[this.options.rowFields.cells]&&
d&&0<d.length){var b=this.getCellByColumnId(a[this.options.rowFields.cells],d[0].valueID);b&&(b[this.options.cellFields.text]=d[0][this.options.cellFields.text],b[this.options.cellFields.value]=d[0][this.options.cellFields.value])}(d=this.getRowParent(c))&&this.processDataDropAtTargetGroup(a,d)};b.prototype.processDataDropAtTargetRow=function(a,c,d){for(var b=0;b<this.groups.length;b++){var h=this.groups[b][this.options.groupFields.cid],f=this.getCellByColumnId(a[this.options.rowFields.cells],h);
h=this.getCellByColumnId(c[this.options.rowFields.cells],h);f&&h&&(f[this.options.cellFields.text]=h[this.options.cellFields.text],f[this.options.cellFields.value]=h[this.options.cellFields.value])}switch(d){case 1:this.insertRowBefore(a,c);break;case 2:this.insertRowAfter(a,c)}};b.prototype.getFirstGroupChildRow=function(a){return a&&a.rows&&0<a.rows.length?"group"==a.rows[0].type?this.getFirstGroupChildRow(a.rows[0]):a.rows[0]:null};b.prototype.collapse=function(a){this.toggle(a,!1)};b.prototype.expand=
function(a){this.toggle(a,!0)};b.prototype.toggle=function(a,c){if(this.isEnabled)if(a){if((a[this.options.rowFields.hasChildren]||a[this.options.rowFields.rows]&&0!=a[this.options.rowFields.rows].length)&&!(c&&0!=a[this.options.rowFields.expanded]||!1===c&&0==a[this.options.rowFields.expanded])){var d=void 0!==c?c:!1!==a[this.options.rowFields.expanded]?!0:!1,b={cancel:!1,row:a};void 0!==c?c?this.beforeExpand.emit(b):this.beforeCollapse.emit(b):d?this.beforeCollapse.emit(b):this.beforeExpand.emit(b);
1!=b.cancel&&(d=void 0!=c?c:!d,d!=a[this.options.rowFields.expanded]&&(a[this.options.rowFields.expanded]=d,"group"==a.type&&this.updateGroupExpandValue(a[this.options.rowFields.id],d),this.updateCurrentLayout()),this.isRowExpanded(a)?this.afterExpand.emit({row:a}):this.afterCollapse.emit({row:a}))}}else{d=this.getFullList();for(b=0;b<d.length;b++)d[b][this.options.rowFields.expanded]=c,"group"==d[b].type&&this.updateGroupExpandValue(d[b][this.options.rowFields.id],c);this.updateCurrentLayout()}};
b.prototype.changeCursor=function(a){a="initial";this.isEnabled&&this.columnReorderActive&&(a="no-drop");this.gridCursor=a};b.prototype.findGroupById=function(a){var c=null;if(this.groups)for(var d=0;d<this.groups.length;d++)if(this.groups[d][this.options.groupFields.id]==a){c=this.groups[d];break}return c};b.prototype.findColumnById=function(a){return this.dataService.findObjectById(a,this.columnDataKey)};b.prototype.getColumnRealIndex=function(a){var c=this.dataService.getList(null,this.columnDataKey);
return 0<=a&&a<c.length&&a<this.currentColumnList.length?c.indexOf(this.currentColumnList[a].data):-1};b.prototype.getCellIndexById=function(a,c,d){var b=-1;if(a){c=this.getColumnRealIndex(c);for(var h=0;h<a.length;h++)if(void 0==a[h][this.options.cellFields.cid]){b=c;break}else if(a[h][this.options.cellFields.cid]==d){b=h;break}}return b};b.prototype.getColumnFromCell=function(a,c){var d=null;if(a[this.options.cellFields.cid])for(var b=0;b<this.currentColumnList.length;b++){if(this.currentColumnList[b].data[this.options.columnFields.id]==
a[this.options.cellFields.cid]){d=this.currentColumnList[b].data;break}}else 0<=c&&c<this.currentColumnList.length&&(d=this.currentColumnList[c].data);return d};b.prototype.getCellAlignment=function(a){return a?a[this.options.columnFields.contentAlignment]:""};b.prototype.getColumnAlignment=function(a,c){return a?c?a[this.options.columnFields.footerAlignment]:a[this.options.columnFields.headerAlignment]:""};b.prototype.isGroupExpandedFromRow=function(a){return(a=this.getGroupExpandObj(a[this.options.rowFields.id]))?
a.expanded:!0};b.prototype.isGroupExpanded=function(a){return a?a[this.options.groupFields.expanded]||void 0===a[this.options.groupFields.expanded]?!0:!1:!0};b.prototype.isRowExpanded=function(a){return a?a[this.options.rowFields.expanded]||void 0===a[this.options.rowFields.expanded]?!0:!1:!0};b.prototype.isThereVisibleChildren=function(a){var c=!1;if(a&&(a=a[this.options.rowFields.rows])&&0<a.length)for(var d=0;d<a.length;d++)if(this.isRowAllowed(a[d])&&!this.isRowFixed(a[d])){c=!0;break}return c};
b.prototype.getGroupTextFromColumn=function(a){var c="";a&&((c=a[this.options.columnFields.groupText])&&""!=c||(c=a[this.options.columnFields.headerText]));return c};b.prototype.getGroupText=function(a){var c="",d=this.getColumnById(a.cid);d?c=this.getGroupTextFromColumn(d):this.options.grouping&&this.options.grouping.dropdown&&this.options.grouping.dropdown.items&&(a=this.commonService.getObjFromListById(this.options.grouping.dropdown.items,a.cid))&&(c=a.text);return c};b.prototype.updateDragGroupElem=
function(a,c){var d=this.commonService.getPadding(this.groupingPanelElem.nativeElement),b=this.commonService.getPageRect(this.groupingPanelElem.nativeElement),h=this.commonService.getShiftPos(),f=this.commonService.getMousePos(a);f.x-=b.left+h.x;f.y-=b.top+h.y;this.dragGroupElemSize.width=this.dragGroupElem.nativeElement.offsetWidth;b=f.x-this.dragGroupElemSize.width/2;this.dragGroupSettings.top=d.top;this.dragGroupSettings.left=b;this.dragGroupSettings.display="block";this.dragGroupSettings.label=
c};b.prototype.groupPanelMouseEnter=function(a){this.isEnabled&&(this.isGroupPanelHovered=!0,1==a.which&&this.columnReorderActive&&this.reorderColumn?(this.restoreColumnOrder(),this.dragGroupSettings.display="none",this.dragGroupSettings.label=this.reorderColumn[this.options.columnFields.headerText],this.groupReorderActive=!0,this.reorderGroup=null,this.dropMark(a)):this.gridCursor="default");a.stopPropagation()};b.prototype.groupPanelMouseMove=function(a){if(this.isEnabled&&1==a.which&&(this.columnReorderActive&&
this.reorderColumn||this.groupReorderActive&&this.reorderGroup)){this.isGroupPanelHovered=!0;var c=this.commonService.getPageRect(this.groupingPanelElem.nativeElement),d=this.commonService.getShiftPos(),b=this.commonService.getMousePos(a);b.x-=c.left+d.x;b.y-=c.top+d.y;c="";this.reorderColumn?c=this.getGroupTextFromColumn(this.reorderColumn):this.reorderGroup&&(c=this.getGroupText(this.reorderGroup));this.updateDragGroupElem(a,c);this.dropMark(a);this.gridCursor="default";this.reorderGroup&&this.groups.indexOf(this.reorderGroup)}a.stopPropagation()};
b.prototype.groupPanelMouseLeave=function(a){this.isGroupPanelHovered=!1;this.dragGroupSettings.display="none"};b.prototype.checkColumnPresence=function(a){for(var c=!1,d=0;d<this.groups.length;d++)if(this.groups[d].cid==a){c=!0;break}return c};b.prototype.groupPanelMouseUp=function(a){if(this.isEnabled&&1==a.which&&(this.columnReorderActive&&this.reorderColumn||this.groupReorderActive&&this.reorderGroup)){if(this.groupReorderActive&&this.reorderGroup){var c=this.groups.indexOf(this.reorderGroup),
d=this.groups.indexOf(this.hoverGroup);c!=d&&(this.moveObject(c,d,this.groups),this.updateLayout(),this.groupOrderChanged.emit(null))}else{c=this.reorderColumn[this.options.columnFields.id];var b={cid:c};this.hoverGroup?(d=this.groups.indexOf(this.hoverGroup),0<=d&&!this.checkColumnPresence(c)&&(this.groups.splice(d,0,b),this.updateLayout(),this.groupOrderChanged.emit(null))):this.checkColumnPresence(c)||this.addGroup(b)&&this.groupOrderChanged.emit(null)}this.resetReorderColumnSettings();this.hoverGroup=
null;this.dropMark(a);this.dragGroupSettings.display="none";this.gridCursor="default";a.stopPropagation()}};b.prototype.groupMouseEnter=function(a,c){this.isEnabled&&1==a.which&&(this.hoverGroup=c,a.stopPropagation())};b.prototype.groupMouseLeave=function(a,c){this.isEnabled&&1==a.which&&(this.hoverGroup=null,a.stopPropagation())};b.prototype.groupMouseDown=function(a,c){this.isEnabled&&1==a.which&&(this.groupReorderActive=!0,this.reorderGroup=c,this.updateDragGroupElem(a,this.getGroupText(this.reorderGroup)));
a.stopPropagation()};b.prototype.groupButtonMouseDown=function(a,c){this.isEnabled&&1==a.which&&this.removeGroup(c);a.stopPropagation()};b.prototype.addGroup=function(a){var c={cancel:!1,group:a};this.groupAdding.emit(c);1!=c.cancel&&(this.groups.push(a),this.updateLayout(),this.groupAdded.emit({group:a}))};b.prototype.removeGroup=function(a){var c=this.groups.indexOf(a);if(0<=c){var b={cancel:!1,group:a};this.groupRemoving.emit(b);1!=b.cancel&&(this.groups.splice(c,1),this.updateLayout(),this.groupRemoved.emit({group:a}))}};
b.prototype.groupListItemSelected=function(a){this.checkColumnPresence(a.id)||this.addGroup({cid:a.id});this.isGroupListItemSelected=!0};b.prototype.groupListMouseDown=function(a){this.isGroupListItemSelected||a.stopPropagation()};b.prototype.onAddGroupDropDownOpen=function(a){this.isGroupListItemSelected=!1};b.prototype.columnMouseDown=function(a,c){if(this.isEnabled)switch(a.which){case 1:if(0<=this.resizeColumnIndex&&this.resizeColumnIndex<this.currentColumnList.length){var b=this.commonService.getShiftPos();
this.columnStartPos={x:a.pageX-b.x,y:a.pageY-b.y};this.isColumnResizing=!0;this.resizeColumn=this.currentColumnList[this.resizeColumnIndex].data}else this.processColumnSelection(a,c.data),1==this.options.allowColumnReorder&&0!=c.data[this.options.columnFields.allowDrag]&&(this.startColumnReorder=!0);break;case 2:this.processColumnSelection(a,c.data)}};b.prototype.columnMouseUp=function(a,c){this.isEnabled&&1==a.which&&this.columnClick.emit({event:a,column:c.data})};b.prototype.columnMouseMove=function(a,
c){if(this.isEnabled&&!this.isScrollActive)if(this.resizeColumnIndex=-1,this.startColumnReorder&&!this.columnReorderActive)this.columnReorderActive=!0,this.reorderColumn=c.data,this.reorderColumnObj=c,this.reorderColumnStartPos.left=a.pageX,this.reorderColumnCurrentPos.left=a.pageX,this.updateOrignalScrollColumnList(),this.updateReorderColumnPos();else if(!this.columnReorderActive&&this.columnElems){var b=this.columnElems.toArray(),e=this.getColumnCurrentIndex(c.data),h=e-this.viewIndexRange.left;
if(0<=h&&h<b.length){b=b[h].nativeElement;h=this.commonService.getShiftPos();var f=this.commonService.getPageRect(b);b=a.pageX-h.x;h=a.pageY-h.y;var g={top:f.top,right:f.right,bottom:f.bottom,left:f.right-10};f={top:f.top,right:f.left+10,bottom:f.bottom,left:f.left};var k=this.getColumnAllowResize(c.data);k.right&&this.commonService.checkHit(b,h,g)?this.resizeColumnIndex=this.isAutoSizeColumnsActive?e+1:e:k.left&&this.commonService.checkHit(b,h,f)&&(this.resizeColumnIndex=this.isAutoSizeColumnsActive?
e:e-1);this.isColumnWidthFixed(this.resizeColumnIndex)&&(this.resizeColumnIndex=-1);this.gridCursor=0<=this.resizeColumnIndex||this.isColumnResizing?"ew-resize":"default"}}else this.gridCursor="default";else this.gridCursor="default"};b.prototype.columnMouseEnter=function(a,c){!this.isEnabled||this.isScrollActive||this.isColumnResizing||this.columnReorderActive||(this.hoverColumn=c.data,this.updateColumnStyle(c))};b.prototype.columnMouseLeave=function(a,c){!this.isEnabled||this.isScrollActive||this.isColumnResizing||
this.columnReorderActive||(this.hoverColumn=null,this.gridCursor=this.isColumnResizing?"ew-resize":"default",this.updateColumnStyle(c),this.dropMark(a))};b.prototype.gridMouseMove=function(a){this.isGridHovered=!1;this.isEnabled&&1==a.which&&this.columnReorderActive&&this.reorderColumn&&(this.isGridHovered=!0,this.reorderColumnCurrentPos.left=a.pageX,this.updateReorderColumnPos(),a.stopPropagation())};b.prototype.gridMouseUp=function(a){if(1==a.which&&this.reorderColumn&&0<=this.reorderNewColIndex&&
this.reorderNewColIndex<this.originalScrollColumnList.length){a=this.columns.indexOf(this.reorderColumn);var c=this.columns.indexOf(this.originalScrollColumnList[this.reorderNewColIndex].data);c!=a&&(this.moveObject(a,c,this.columns),this.columnOrderChanged.emit({column:this.reorderColumn}),this.updateLayout())}this.resetReorderColumnSettings()};b.prototype.gridMouseLeave=function(a){this.hoverColumn=this.hoverRow=null;this.isGridHovered=!1;this.isEnabled&&1==a.which&&this.columnReorderActive&&this.restoreColumnOrder()};
b.prototype.rowMouseEnter=function(a,c){!this.isEnabled||this.isScrollActive||this.isColumnResizing||this.columnReorderActive||(this.hoverRow=c.data,this.updateRowStyle(c))};b.prototype.rowMouseLeave=function(a,c){!this.isEnabled||this.isScrollActive||this.isColumnResizing||this.columnReorderActive||(this.hoverRow=null,this.updateRowStyle(c))};b.prototype.resetReorderColumnSettings=function(){this.reorderColumn=this.reorderColumnObj=null;this.groupReorderActive=this.startColumnReorder=this.columnReorderActive=
!1;this.reorderGroup=null};b.prototype.processLeftArrowKey=function(a){var c=this.getColumnFromCell(a.data,a.colIndex);if(c&&this.getColumnIndexFromList(c)==this.expandColIndex&&0<=a.rowIndex&&a.rowIndex<this.scrollRowList.length&&(c=this.scrollRowList[a.rowIndex].data,this.isRowExpanded(c)&&this.isThereVisibleChildren(c)))return this.collapse(c),a;if(a=this.getPrevCell(a)){this.currentFocusCell=a.data;this.isFirstCell(a)&&this.scrollPos({x:this.currentScrollPos.x-2*a.width,y:this.currentScrollPos.y});
var b=this;setTimeout(function(){b.refresh()},1)}return a};b.prototype.processRightArrowKey=function(a){var c=this.getColumnFromCell(a.data,a.colIndex);if(c&&this.getColumnIndexFromList(c)==this.expandColIndex&&0<=a.rowIndex&&a.rowIndex<this.scrollRowList.length&&(c=this.scrollRowList[a.rowIndex].data,!this.isRowExpanded(c)&&this.isThereVisibleChildren(c)))return this.expand(c),a;if(a=this.getNextCell(a)){this.currentFocusCell=a.data;this.isLastCell(a)?this.scrollPos({x:this.currentScrollPos.x+2*
a.width,y:this.currentScrollPos.y}):a.colIndex>=this.currentColumnList.length-2&&this.scrollPos({x:this.maxScrollPos.x,y:this.currentScrollPos.y});var b=this;setTimeout(function(){b.refresh()},1)}return a};b.prototype.updateRange=function(){this.viewIndexRange={left:0,middle:999,right:999};for(var a=!1,c=!1,b=!1,e=this.currentScrollPos.x+this.clientRect.width,h=2*e,f=0,g=0;g<this.currentColumnList.length&&(f+=this.getColumnWidth(this.currentColumnList[g].data)+this.columnPadding.left+this.columnPadding.right+
6,!a&&f>=this.currentScrollPos.x&&(this.viewIndexRange.left=g,a=!0),!c&&f>=e&&(this.viewIndexRange.middle=g,c=!0),!b&&f>=h&&(this.viewIndexRange.right=g,b=!0),!a||!b);g++);for(g=f=0;g<this.currentColumnList.length&&g<this.viewIndexRange.left;g++)f+=this.getColumnWidth(this.currentColumnList[g].data)+this.columnPadding.left+this.columnPadding.right+6;this.contentLeftPos=this.currentScrollPos.x-f;this.updateScrollColumnList();this.updateScrollRowList()};b.prototype.updateCurrentLayout=function(){var a=
this;a.resetLayout();a.options.paging.enabled&&(a.updatePageList(),a.updatePageNumber());a.updateCurrentRowList();a.updateRange();a.updateScrollSize();a.updateColumnWidth();a.updateScrollSize();a.updateTimer=setTimeout(function(){a.updateBlockSize();clearTimeout(a.updateTimer)},1)};b.prototype.updateBlockSize=function(){this.blockSize={width:this.bodyElem.nativeElement.offsetWidth,height:this.bodyElem.nativeElement.offsetHeight}};b.prototype.resetLayout=function(){this.updateTimer&&clearTimeout(this.updateTimer);
this.updateTimer=null};b.prototype.updateExpandingColumn=function(){if(void 0!=this.currentExpandColumnID){var a=this.findColumnById(this.currentExpandColumnID);a=this.getColumnCurrentIndex(a);this.expandColIndex=0<=a?a:0}};b.prototype.updateLayout=function(){var a=this;a.allowUpdate&&(a.beforeUpdate.emit(null),a.resetLayout(),a.updateTimer=setTimeout(function(){a.updateCurrentColumnList();a.updateExpandingColumn();a.updateGroupList();a.options.paging.enabled&&a.updatePageList();a.updateCurrentRowList();
a.groupPanelHeight=a.groupingPanelElem?a.groupingPanelElem.nativeElement.offsetHeight:0;a.groupPanelSize.height=a.groupingPanelElem?a.groupingPanelElem.nativeElement.offsetHeight:0;a.paginatorHeight=a.paginatorElem?a.paginatorElem.nativeElement.offsetHeight:0;a.paginatorPos.top=a.elemRef.nativeElement.firstElementChild.clientHeight-a.paginatorHeight+1;a.horScrollElemPos.bottom=0<a.paginatorHeight?a.paginatorHeight-1:0;a.cornerScrollElemPos.bottom=0<a.paginatorHeight?a.paginatorHeight-1:0;a.clientRect=
{width:a.elemRef.nativeElement.firstElementChild.clientWidth,height:a.elemRef.nativeElement.firstElementChild.clientHeight-a.groupPanelHeight-a.paginatorHeight};if(a.groupingPanelElem){var c=a.commonService.getBorderWidth(a.groupingPanelElem.nativeElement),b=a.commonService.getPadding(a.groupingPanelElem.nativeElement);a.groupPanelSize.width=a.clientRect.width-(b.left+b.right)-(c.left+c.right)}a.updateRange();var e=setTimeout(function(){a.columnPadding={top:0,right:0,bottom:0,left:0};var c=[];a.columnElems&&
a.showHeader?c=a.columnElems.toArray():a.footerElems&&a.showFooter?c=a.footerElems.toArray():a.cellElems&&(c=a.cellElems.toArray());c&&0<c.length&&(a.columnPadding=a.commonService.getPadding(c[0].nativeElement.firstElementChild));a.headerHeight=a.headerElem?a.headerElem.nativeElement.offsetHeight:0;a.footerHeight=a.footerElem?a.footerElem.nativeElement.offsetHeight:0;a.updateVisibleRange();a.updateRange();var b=setTimeout(function(){a.blockMarginTop=a.headerHeight;a.updateBlockSize();if(a.rowElems){var c=
a.rowElems.toArray();a.avgRowHeight=0;if(c&&0<c.length){for(var d=0,e=0;e<c.length;e++)d+=c[e].nativeElement.offsetHeight;a.avgRowHeight=Math.floor(d/c.length)}}a.updateScrollSize();a.updateColumnWidth();a.updateScrollSize();a.updateComplete.emit(null);clearTimeout(b)},1);clearTimeout(e)},1);clearTimeout(a.updateTimer)},100))};b.prototype.updateVisibleRange=function(){this.visibleRange=1;var a=this.rowElems.toArray();if(a&&0<a.length){for(var c=0,b=0;b<a.length;b++)c+=a[b].nativeElement.offsetHeight;
a=Math.floor(c/a.length);0<a&&(this.visibleRange=Math.floor((this.clientRect.height-(this.headerHeight+this.footerHeight))/a)+1)}};b.prototype.updateScrollSize=function(){for(var a=this.allColWidth=0;a<this.currentColumnList.length;a++)this.allColWidth+=this.getColumnWidth(this.currentColumnList[a].data)+this.columnPadding.left+this.columnPadding.right+6;this.scrollSize={width:this.allColWidth-this.clientRect.width,height:this.avgRowHeight*this.currentRowList.length-this.clientRect.height+this.headerHeight+
this.footerHeight+this.avgRowHeight};this.isVerScrollVisible()&&(this.scrollSize.width+=16);this.isHorScrollVisible()&&(this.scrollSize.height+=16);this.scrollSize.width=0<this.scrollSize.width?this.scrollSize.width:0;this.scrollSize.height=0<this.scrollSize.height?this.scrollSize.height:0;this.maxScrollPos={x:this.scrollSize.width,y:this.scrollSize.height};this.currentScrollPos.x>this.maxScrollPos.x&&this.changeHorizontalScrollPos(this.maxScrollPos.x);this.currentScrollPos.y>this.maxScrollPos.y&&
this.changeVerticalScrollPos(this.maxScrollPos.y);this.scrollBarSize={width:this.isVerScrollVisible()?this.clientRect.width-20:this.clientRect.width-4,height:this.isHorScrollVisible()?this.clientRect.height-20:this.clientRect.height-4};this.scrollLargeChange={x:this.scrollBarSize.width,y:this.scrollBarSize.height-this.headerHeight-this.footerHeight}};b.prototype.getRowScrollIndex=function(a){for(var c=-1,b=0;b<this.scrollRowList.length;b++)if(this.scrollRowList[b].data==a){c=b;break}return c};b.prototype.onWindowMouseMove=
function(a){if(this.isEnabled&&(1!=a.buttons&&this.resetReorderColumnSettings(),1==a.buttons&&this.isColumnResizing)){var c=this.commonService.getShiftPos();a={x:a.pageX-c.x,y:a.pageY-c.y};if(this.resizeColumn){var b;if(this.isAutoSizeColumnsActive){c=a.x-this.columnStartPos.x;if(0>c){if(b=this.getPrevColumn(this.resizeColumn)){var e=this.getColumnWidth(b)+c,h=this.getColumnWidth(b,"min");e>h?(this.setColumnWidth(b,e),this.updateCellWidth(b),b=this.getColumnWidth(this.resizeColumn)-c,this.setColumnWidth(this.resizeColumn,
b),this.updateCellWidth(this.resizeColumn)):(this.setColumnWidth(b,h),this.updateCellWidth(b))}}else if(b=this.getColumnWidth(this.resizeColumn)-c,e=this.getColumnWidth(this.resizeColumn,"min"),b=b>e?b:e,b>e&&(this.setColumnWidth(this.resizeColumn,b),this.updateCellWidth(this.resizeColumn),b=this.getPrevColumn(this.resizeColumn,!0)))e=this.getColumnWidth(b)+c,this.setColumnWidth(b,e),this.updateCellWidth(b);this.checkWidthChanges()}else b=this.getColumnWidth(this.resizeColumn)+a.x-this.columnStartPos.x,
this.setColumnWidth(this.resizeColumn,0<b?b:0),this.updateCellWidth(this.resizeColumn);this.updateScrollSize()}this.columnStartPos=a}};b.prototype.onWindowMouseUp=function(a){this.isEnabled&&this.isColumnResizing&&(this.isColumnResizing=!1,this.columnSizeChanged.emit({column:this.resizeColumn}),this.updateRange());this.removeDropMark();this.gridCursor="default";this.resetReorderColumnSettings();this.hoverGroup=this.hoverColumn=this.hoverRow=null;this.isCtrlDragEntered=!1;this.isEnabled&&this.refresh()};
b.prototype.getRowLevel=function(a){var b=0;for(a=this.getRowParent(a);a;)b++,a=this.getRowParent(a);return b};b.prototype.getRowParent=function(a){var b=null;if(a)for(var d=0;d<this.fullList.length;d++)if(this.fullList[d][this.options.rowFields.id]==a[this.options.rowFields.pid]){b=this.fullList[d];break}return b};b.prototype.getPrevRow=function(a){var b=null;if(a){var d=this.rows,e=this.getRowParent(a);e&&(d=e[this.options.rowFields.rows]);a=d.indexOf(a);a=0<a?a-1:-1;0<=a&&(b=d[a])}return b};b.prototype.getNextRow=
function(a){var b=null;if(a){var d=this.rows,e=this.getRowParent(a);e&&(d=e[this.options.rowFields.rows]);a=d.indexOf(a);a=a<d.length-1?a+1:-1;0<=a&&(b=d[a])}return b};b.prototype.moveRow=function(a,b,d,e){if(a){this.allowUpdate=!1;var c=-1;switch(b){case integralui_base_grid_1.IntegralUIDirection.At:c=e;break;case integralui_base_grid_1.IntegralUIDirection.Down:e=this.getRowCurrentIndex(a)+1;e<this.currentRowList.length&&(d=this.currentRowList[e].data);break;case integralui_base_grid_1.IntegralUIDirection.First:c=
0;break;case integralui_base_grid_1.IntegralUIDirection.Left:d=this.getRowParent(a);break;case integralui_base_grid_1.IntegralUIDirection.Right:d=this.getPrevRow(a);break;case integralui_base_grid_1.IntegralUIDirection.Up:e=this.getRowCurrentIndex(a)-1,0<=e&&(d=this.currentRowList[e].data)}if(Array.isArray(a)){e=[];for(var f=0;f<a.length;f++){for(var g=!1,k=this.getRowParent(a[f]);k;){if(0<=a.indexOf(k)){g=!0;break}k=this.getRowParent(k)}g||e.push(a[f])}if(0<e.length)if(a=this.getRowCurrentIndex(e[0]),
f=this.getRowCurrentIndex(e[e.length-1]),a<=f)for(f=0;f<e.length;f++)this.moveRowAt(e[f],d,b,c);else for(f=e.length-1;0<=f;f--)this.moveRowAt(e[f],d,b,c)}else this.moveRowAt(a,d,b,c);this.allowUpdate=!0;this.updateCurrentLayout();this.change.emit({type:"move-row"})}};b.prototype.moveRowAt=function(a,b,d,e){b&&this.removeRow(a)&&(d==integralui_base_grid_1.IntegralUIDirection.First||d==integralui_base_grid_1.IntegralUIDirection.Right||d==integralui_base_grid_1.IntegralUIDirection.Last||d==integralui_base_grid_1.IntegralUIDirection.At?
this.insertRowAt(a,e,b):d==integralui_base_grid_1.IntegralUIDirection.Before?this.insertRowBefore(a,b):(d==integralui_base_grid_1.IntegralUIDirection.After||d==integralui_base_grid_1.IntegralUIDirection.Left)&&this.insertRowAfter(a,b))};b.prototype.beginLoad=function(a){a&&(0>this.options.loadRows.indexOf(a)&&this.options.loadRows.push(a),this.refresh())};b.prototype.endLoad=function(a){a=this.options.loadRows.indexOf(a);0<=a&&this.options.loadRows.splice(a,1);this.updateCurrentLayout()};b.prototype.isRowLoading=
function(a){return 0<=this.options.loadRows.indexOf(a)?!0:!1};b.prototype.getColumnOpacity=function(a){return this.columnReorderActive&&a.data==this.reorderColumn&&!this.isGroupPanelHovered&&this.isGridHovered?0:1};b.prototype.getHeaderRect=function(){return this.headerRowElem?this.commonService.getPageRect(this.headerRowElem.nativeElement):{top:0,right:0,bottom:0,left:0,height:0,width:0,x:0,y:0}};b.prototype.scrollTo=function(a){if(a){this.suspendLayout();for(var b=this.getRowParent(a);null!=b;)this.expand(b),
b=this.getRowParent(b);this.resumeLayout();var d=this,e=setTimeout(function(){var b=d.getRowCurrentIndex(a);0<=b&&(d.scrollPos({x:d.currentScrollPos.x,y:d.avgRowHeight*(b+1-d.visibleRange/2)}),d.updateLayout());clearTimeout(e)},150)}};b.prototype.rowMouseDown=function(a,b){this.isEnabled&&this.processRowSelection(a,b.data);a.stopPropagation()};b.prototype.rowMouseUp=function(a,b){this.isEnabled&&this.updateRowSelection(a,b.data)};b.prototype.rowClickEvent=function(a,b){this.isEnabled&&1==a.which&&
this.rowClick.emit({row:b.data});a.stopPropagation()};b.prototype.rowDblClickEvent=function(a,b){if(this.isEnabled){var c={cancel:!1,row:b.data};this.rowDblClick.emit(c);1!=c.cancel&&this.toggle(b.data)}a.stopPropagation()};b.prototype.updateColumnStyle=function(a){if(a){a.style={header:[],footer:[],sorting:[]};a.style.header.push(this.columnHeaderClassName);a.style.header.push(this.options.currentStyle.column.header.normal);a.data==this.selectedColumn?a.style.header.push(this.options.currentStyle.column.header.selected):
a.data==this.hoverColumn&&a.style.header.push(this.options.currentStyle.column.header.hovered);a.style.footer.push(this.columnFooterClassName);a.style.footer.push(this.options.currentStyle.column.footer.normal);a.data==this.selectedColumn?a.style.footer.push(this.options.currentStyle.column.footer.selected):a.data==this.hoverColumn&&a.style.footer.push(this.options.currentStyle.column.footer.hovered);switch(this.gridLines){case integralui_base_grid_1.IntegralUIGridLines.None:a.style.header.push(this.options.currentStyle.gridLines.none);
a.style.footer.push(this.options.currentStyle.gridLines.none);break;case integralui_base_grid_1.IntegralUIGridLines.Horizontal:a.style.header.push(this.options.currentStyle.gridLines.horizontal);a.style.footer.push(this.options.currentStyle.gridLines.horizontal);break;case integralui_base_grid_1.IntegralUIGridLines.Vertical:a.style.header.push(this.options.currentStyle.gridLines.vertical);a.style.footer.push(this.options.currentStyle.gridLines.vertical);break;default:a.style.header.push(this.options.currentStyle.gridLines.both),
a.style.footer.push(this.options.currentStyle.gridLines.both)}if(this.isSortingAllowed()&&this.isSortingColumn(a.data))switch(this.options.sorting){case integralui_core_1.IntegralUISortOrder.Ascending:a.style.sorting.push(this.options.currentStyle.column.sorting.normal.ascending);a.data==this.selectedColumn&&a.style.sorting.push(this.options.currentStyle.column.sorting.selected.ascending);break;case integralui_core_1.IntegralUISortOrder.Descending:a.style.sorting.push(this.options.currentStyle.column.sorting.normal.descending),
a.data==this.selectedColumn&&a.style.sorting.push(this.options.currentStyle.column.sorting.selected.descending)}}};b.prototype.updateRowStyle=function(a){if(a){a.style={row:[],expandBox:[],cell:[]};a.style.row.push(this.rowClassName);a.style.row.push(this.options.currentStyle.row.general.normal);a.style.cell.push(this.cellClassName);a.style.cell.push(this.options.currentStyle.row.cell.normal);this.isRowEnabled(a.data)?this.isRowSelected(a.data)?(a.style.row.push(this.options.currentStyle.row.general.selected),
a.style.cell.push(this.options.currentStyle.row.cell.selected)):this.isRowHovered(a.data)&&(a.style.row.push(this.options.currentStyle.row.general.hovered),a.style.cell.push(this.options.currentStyle.row.cell.hovered)):(a.style.row.push(this.options.currentStyle.row.general.disabled),a.style.cell.push(this.options.currentStyle.row.cell.disabled));switch(this.gridLines){case integralui_base_grid_1.IntegralUIGridLines.None:a.style.cell.push(this.options.currentStyle.gridLines.none);break;case integralui_base_grid_1.IntegralUIGridLines.Horizontal:a.style.cell.push(this.options.currentStyle.gridLines.horizontal);
break;case integralui_base_grid_1.IntegralUIGridLines.Vertical:a.style.cell.push(this.options.currentStyle.gridLines.vertical);break;default:a.style.cell.push(this.options.currentStyle.gridLines.both)}(this.isThereChildRows||a.data[this.options.rowFields.hasChildren])&&a.style.expandBox.push(this.options.currentStyle.row.expandBox.general);if(a.data[this.options.rowFields.hasChildren]&&(this.isThereVisibleChildren(a.data)||!a.data[this.options.rowFields.rows]||a.data[this.options.rowFields.rows]&&
0==a.data[this.options.rowFields.rows].length)||this.isThereVisibleChildren(a.data))this.isRowLoading(a.data)?a.style.expandBox.push(this.options.currentStyle.row.expandBox.load):!1!==a.data[this.options.rowFields.expanded]?a.style.expandBox.push(this.options.currentStyle.row.expandBox.collapsed):a.style.expandBox.push(this.options.currentStyle.row.expandBox.expanded);for(var b=0;b<a.cells.length;b++){var d=a.cells[b];d.style=this.options.allowFocus&&d.data==this.currentFocusCell?{content:"iui-grid-row-cell-content iui-grid-row-cell-content-focused"}:
{content:"iui-grid-row-cell-content"}}}};b.prototype.getColumnStyle=function(a){return a?{header:this.getColumnHeaderStyle(a.header),body:this.getColumnBodyStyle(a.body),footer:this.getColumnFooterStyle(a.footer),sorting:this.getColumnSortingStyle(a.sorting)}:this.getDefaultColumnStyle()};b.prototype.getColumnHeaderStyle=function(a){return this.commonService.isString(a)?a:a?{cell:this.commonService.isFieldAvailable(a.cell,this.columnHeaderClassName+"-cell"),disabled:this.commonService.isFieldAvailable(a.disabled,
this.columnHeaderClassName+"-disabled"),normal:this.commonService.isFieldAvailable(a.normal,this.columnHeaderClassName),hovered:this.commonService.isFieldAvailable(a.hovered,this.columnHeaderClassName+"-hovered"),selected:this.commonService.isFieldAvailable(a.selected,this.columnHeaderClassName+"-selected")}:this.getDefaultColumnHeaderStyle()};b.prototype.getColumnBodyStyle=function(a){return this.commonService.isString(a)?a:a?{cell:this.commonService.isFieldAvailable(a.cell,this.columnBodyClassName+
"-cell"),disabled:this.commonService.isFieldAvailable(a.disabled,this.columnBodyClassName+"-disabled"),normal:this.commonService.isFieldAvailable(a.normal,this.columnBodyClassName),hovered:this.commonService.isFieldAvailable(a.hovered,this.columnBodyClassName+"-hovered"),selected:this.commonService.isFieldAvailable(a.selected,this.columnBodyClassName+"-selected")}:this.getDefaultColumnBodyStyle()};b.prototype.getColumnFooterStyle=function(a){return this.commonService.isString(a)?a:a?{cell:this.commonService.isFieldAvailable(a.cell,
this.columnFooterClassName+"-cell"),disabled:this.commonService.isFieldAvailable(a.disabled,this.columnFooterClassName+"-disabled"),normal:this.commonService.isFieldAvailable(a.normal,this.columnFooterClassName),hovered:this.commonService.isFieldAvailable(a.hovered,this.columnFooterClassName+"-hovered"),selected:this.commonService.isFieldAvailable(a.selected,this.columnFooterClassName+"-selected")}:this.getDefaultColumnFooterStyle()};b.prototype.getColumnSortingStyle=function(a){return a?{normal:this.getColumnSortingNormalStyle(a.normal),
selected:this.getColumnSortingSelectedStyle(a.selected)}:this.getDefaultColumnSortingStyle()};b.prototype.getColumnSortingNormalStyle=function(a){return this.commonService.isString(a)?a:a?{ascending:this.commonService.isFieldAvailable(a.ascending,this.sortingClassName+"-ascending"),descending:this.commonService.isFieldAvailable(a.descending,this.sortingClassName+"-descending")}:{ascending:this.defaultStyle.column.sorting.normal.ascending,descending:this.defaultStyle.column.sorting.normal.descending}};
b.prototype.getColumnSortingSelectedStyle=function(a){return this.commonService.isString(a)?a:a?{ascending:this.commonService.isFieldAvailable(a.ascending,this.sortingClassName+"-ascending-selected"),descending:this.commonService.isFieldAvailable(a.descending,this.sortingClassName+"-descending-selected")}:{ascending:this.defaultStyle.column.sorting.selected.ascending,descending:this.defaultStyle.column.sorting.selected.descending}};b.prototype.getRowStyle=function(a){return a?{general:this.getRowGeneralStyle(a.general),
expandBox:this.getRowExpandBoxStyle(a.expandBox),cell:this.getRowCellStyle(a.cell)}:this.getDefaultRowStyle()};b.prototype.getRowGeneralStyle=function(a){return this.commonService.isString(a)?a:a?{disabled:this.commonService.isFieldAvailable(a.disabled,this.rowClassName+"-disabled"),focused:this.commonService.isFieldAvailable(a.focused,this.rowClassName+"-focused"),normal:this.commonService.isFieldAvailable(a.normal,this.rowClassName),hovered:this.commonService.isFieldAvailable(a.hovered,this.rowClassName+
"-hovered"),selected:this.commonService.isFieldAvailable(a.selected,this.rowClassName+"-selected")}:this.getDefaultRowGeneralStyle()};b.prototype.getRowExpandBoxStyle=function(a){return this.commonService.isString(a)?a:a?{general:this.commonService.isFieldAvailable(a.disabled,this.expandBoxClassName),load:this.commonService.isFieldAvailable(a.focused,this.expandBoxClassName+"-load"),expanded:this.commonService.isFieldAvailable(a.normal,this.expandBoxClassName+"-open"),collapsed:this.commonService.isFieldAvailable(a.hovered,
this.expandBoxClassName+"-close")}:this.getDefaultRowExpandBoxStyle()};b.prototype.getRowCellStyle=function(a){return this.commonService.isString(a)?a:a?{disabled:this.commonService.isFieldAvailable(a.disabled,this.cellClassName+"-disabled"),focused:this.commonService.isFieldAvailable(a.focused,this.cellClassName+"-focused"),normal:this.commonService.isFieldAvailable(a.normal,this.cellClassName),hovered:this.commonService.isFieldAvailable(a.hovered,this.cellClassName+"-hovered"),selected:this.commonService.isFieldAvailable(a.selected,
this.cellClassName+"-selected")}:this.getDefaultRowCellStyle()};b.prototype.getGridLinesStyle=function(a){return a?{none:this.commonService.isFieldAvailable(a.none,this.gridLinesClassName+"-none"),horizontal:this.commonService.isFieldAvailable(a.horizontal,this.gridLinesClassName+"-horizontal"),vertical:this.commonService.isFieldAvailable(a.vertical,this.gridLinesClassName+"-vertical"),both:this.commonService.isFieldAvailable(a.both,this.gridLinesClassName+"-both")}:this.getDefaultGridLinesStyle()};
b.prototype.getDefaultGridStyle=function(){return{general:this.getDefaultGeneralStyle(),column:this.getDefaultColumnStyle(),row:this.getDefaultRowStyle(),gridLines:this.getDefaultGridLinesStyle()}};b.prototype.getDefaultColumnStyle=function(){return{header:this.getDefaultColumnHeaderStyle(),body:this.getDefaultColumnBodyStyle(),footer:this.getDefaultColumnFooterStyle(),sorting:this.getDefaultColumnSortingStyle()}};b.prototype.getDefaultColumnHeaderStyle=function(){return{cell:this.defaultStyle.column.header.cell,
disabled:this.defaultStyle.column.header.disabled,normal:this.defaultStyle.column.header.normal,hovered:this.defaultStyle.column.header.hovered,selected:this.defaultStyle.column.header.selected}};b.prototype.getDefaultColumnBodyStyle=function(){return{cell:this.defaultStyle.column.body.cell,disabled:this.defaultStyle.column.body.disabled,normal:this.defaultStyle.column.body.normal,hovered:this.defaultStyle.column.body.hovered,selected:this.defaultStyle.column.body.selected}};b.prototype.getDefaultColumnFooterStyle=
function(){return{cell:this.defaultStyle.column.footer.cell,disabled:this.defaultStyle.column.footer.disabled,normal:this.defaultStyle.column.footer.normal,hovered:this.defaultStyle.column.footer.hovered,selected:this.defaultStyle.column.footer.selected}};b.prototype.getDefaultColumnSortingStyle=function(){return{normal:{ascending:this.defaultStyle.column.sorting.normal.ascending,descending:this.defaultStyle.column.sorting.normal.descending},selected:{ascending:this.defaultStyle.column.sorting.selected.ascending,
descending:this.defaultStyle.column.sorting.selected.descending}}};b.prototype.getDefaultRowStyle=function(){return{general:this.getDefaultRowGeneralStyle(),expandBox:this.getDefaultRowExpandBoxStyle(),cell:this.getDefaultRowCellStyle()}};b.prototype.getDefaultRowGeneralStyle=function(){return{disabled:this.defaultStyle.row.general.disabled,focused:this.defaultStyle.row.general.focused,normal:this.defaultStyle.row.general.normal,hovered:this.defaultStyle.row.general.hovered,selected:this.defaultStyle.row.general.selected}};
b.prototype.getDefaultRowExpandBoxStyle=function(){return{general:this.defaultStyle.row.expandBox.general,load:this.defaultStyle.row.expandBox.load,expanded:this.defaultStyle.row.expandBox.expanded,collapsed:this.defaultStyle.row.expandBox.collapsed}};b.prototype.getDefaultRowCellStyle=function(){return{disabled:this.defaultStyle.row.cell.disabled,focused:this.defaultStyle.row.cell.focused,normal:this.defaultStyle.row.cell.normal,hovered:this.defaultStyle.row.cell.hovered,selected:this.defaultStyle.row.cell.selected}};
b.prototype.getDefaultGridLinesStyle=function(){return{none:this.defaultStyle.gridLines.none,horizontal:this.defaultStyle.gridLines.horizontal,vertical:this.defaultStyle.gridLines.vertical,both:this.defaultStyle.gridLines.both}};b.prototype.updateStyle=function(a){this.options.currentStyle=a?{general:this.getGeneralStyle(a.general),column:this.getColumnStyle(a.column),row:this.getRowStyle(a.row),gridLines:this.getGridLinesStyle(a.gridLines)}:this.getDefaultGridStyle()};b.prototype.resetRefresh=function(){this.refreshTimer&&
clearTimeout(this.refreshTimer);this.refreshTimer=null};b.prototype.refresh=function(a){this.resetRefresh();this.updateControlClass();for(a=0;a<this.scrollColumnList.length;a++)this.updateColumnStyle(this.scrollColumnList[a]);for(a=0;a<this.scrollRowList.length;a++)this.updateRowStyle(this.scrollRowList[a])};return b}(integralui_base_grid_1.IntegralUIBaseGrid);
__decorate([core_1.ContentChildren(integralui_core_1.IntegralUITemplate),__metadata("design:type",core_1.QueryList)],IntegralUIGrid.prototype,"templates",void 0);__decorate([core_1.ViewChild("groupingPanel",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUIGrid.prototype,"groupingPanelElem",void 0);__decorate([core_1.ViewChild("dragGroup",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUIGrid.prototype,"dragGroupElem",void 0);
__decorate([core_1.ViewChildren("headerCellElem",{read:core_1.ElementRef}),__metadata("design:type",core_1.QueryList)],IntegralUIGrid.prototype,"columnElems",void 0);__decorate([core_1.ViewChildren("footerCellElem",{read:core_1.ElementRef}),__metadata("design:type",core_1.QueryList)],IntegralUIGrid.prototype,"footerElems",void 0);__decorate([core_1.ViewChildren("rowElem",{read:core_1.ElementRef}),__metadata("design:type",core_1.QueryList)],IntegralUIGrid.prototype,"rowElems",void 0);
__decorate([core_1.ViewChildren("rowCellElem",{read:core_1.ElementRef}),__metadata("design:type",core_1.QueryList)],IntegralUIGrid.prototype,"cellElems",void 0);__decorate([core_1.ViewChild("header",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUIGrid.prototype,"headerElem",void 0);__decorate([core_1.ViewChild("headerRow",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUIGrid.prototype,"headerRowElem",void 0);
__decorate([core_1.ViewChild("footer",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUIGrid.prototype,"footerElem",void 0);__decorate([core_1.ViewChild("body",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUIGrid.prototype,"bodyElem",void 0);__decorate([core_1.ViewChild("verScroll"),__metadata("design:type",integralui_scrollbar_1.IntegralUIScrollBar)],IntegralUIGrid.prototype,"verScrollCmp",void 0);
__decorate([core_1.ViewChild("horScroll"),__metadata("design:type",integralui_scrollbar_1.IntegralUIScrollBar)],IntegralUIGrid.prototype,"horScrollCmp",void 0);__decorate([core_1.ViewChild("contentBlock",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],IntegralUIGrid.prototype,"contentRef",void 0);__decorate([core_1.ViewChild("paginator",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUIGrid.prototype,"paginatorElem",void 0);
__decorate([core_1.Input(),__metadata("design:type",Boolean)],IntegralUIGrid.prototype,"autoExpand",void 0);__decorate([core_1.Input(),__metadata("design:type",Number),__metadata("design:paramtypes",[Number])],IntegralUIGrid.prototype,"expandColumnIndex",null);__decorate([core_1.Input(),__metadata("design:type",Number),__metadata("design:paramtypes",[Number])],IntegralUIGrid.prototype,"expandColumnID",null);
__decorate([core_1.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],IntegralUIGrid.prototype,"grouping",null);__decorate([core_1.Input(),__metadata("design:type",Array),__metadata("design:paramtypes",[Array])],IntegralUIGrid.prototype,"groups",null);__decorate([core_1.Input(),__metadata("design:type",Number),__metadata("design:paramtypes",[Number])],IntegralUIGrid.prototype,"indent",null);
__decorate([core_1.Input(),__metadata("design:type",Boolean),__metadata("design:paramtypes",[Boolean])],IntegralUIGrid.prototype,"showHeader",null);__decorate([core_1.Input(),__metadata("design:type",Boolean),__metadata("design:paramtypes",[Boolean])],IntegralUIGrid.prototype,"showFooter",null);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGrid.prototype,"afterCollapse",void 0);
__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGrid.prototype,"afterExpand",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGrid.prototype,"beforeCollapse",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGrid.prototype,"beforeExpand",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGrid.prototype,"groupAdding",void 0);
__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGrid.prototype,"groupAdded",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGrid.prototype,"groupRemoving",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGrid.prototype,"groupRemoved",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGrid.prototype,"groupOrderChanged",void 0);
__decorate([core_1.HostListener("document:mousemove",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],IntegralUIGrid.prototype,"onWindowMouseMove",null);__decorate([core_1.HostListener("document:mouseup",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],IntegralUIGrid.prototype,"onWindowMouseUp",null);
IntegralUIGrid=__decorate([core_1.Component({selector:"iui-grid",template:'\n\t\t<div [ngClass]="getControlClass()" (DOMMouseScroll)="gridMouseWheel($event)" (mousewheel)="gridMouseWheel($event)" (mousemove)="gridMouseMove($event)" (mouseup)="gridMouseUp($event)" (mouseleave)="gridMouseLeave($event)" [ngStyle]="{ cursor: gridCursor }" (dragenter)="ctrlDragEnter($event)" (dragleave)="ctrlDragLeave($event)" (dragover)="ctrlDragOver($event)" (drop)="ctrlDragDrop($event)" (scroll)="onGridScroll($event)" (touchstart)="ctrlTouchStart($event)" (touchend)="ctrlTouchEnd($event)">\n\t\t\t<div *ngIf="grouping.enabled" class="iui-grid-grouping-panel" (mouseenter)="groupPanelMouseEnter($event)" (mousemove)="groupPanelMouseMove($event)" (mouseleave)="groupPanelMouseLeave($event)" (mouseup)="groupPanelMouseUp($event)" [ngStyle]="{ width: groupPanelSize.width + \'px\' }" #groupingPanel>\n\t\t\t\t<span *ngFor="let group of activeGroups; let i = index" (mouseenter)="groupMouseEnter($event, group)" (mouseleave)="groupMouseLeave($event, group)">\n\t\t\t\t\t<div class="iui-grid-grouping-panel-item" [ngClass]="{ \'iui-grid-grouping-marker\': i < activeGroups.length - 1 }" [ngStyle]="{ \'margin-left\': group==hoverGroup ? groupReorderMargin + \'px\' : 0, display: group == reorderGroup ? \'none\' : \'inline-block\' }">\n\t\t\t\t\t\t<p class="iui-grid-grouping-panel-item-label" (mousedown)="groupMouseDown($event, group)">{{getGroupText(group)}}</p>\n\t\t\t\t\t\t<span class="iui-grid-grouping-panel-item-button" (mousedown)="groupButtonMouseDown($event, group)"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</span>\n\t\t\t\t<div *ngIf="!groupReorderActive" class="iui-grid-grouping-panel-toolbar">\n\t\t\t\t\t<div class="iui-grid-grouping-panel-toolbar-button-add" [iuiDropDown]="options.grouping.dropdown" (dropDownOpen)="onAddGroupDropDownOpen($event)">\n\t\t\t\t\t\t<span></span>\n                        <ng-template let-obj [iuiTemplate]="{ type: \'dropdown\' }">\n                            <ul *ngIf="isEnabled" class="iui-grid-grouping-panel-dropdown-list" (mousedown)="groupListMouseDown($event)">\n                                <li *ngFor="let item of options.grouping.dropdown.items" (mousedown)="groupListItemSelected(item)">\n                                    <span class="iui-grid-grouping-panel-dropdown-list-checkbox" [ngClass]="{ \'iui-grid-grouping-panel-dropdown-list-checkbox-true\': checkColumnPresence(item.id) }"></span>\n                                    <span>{{item.text}}</span>\n                                </li>\n                            </ul>\n                        </ng-template>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div *ngIf="activeGroups.length==0" class="iui-grid-grouping-panel-item" style="margin-left:-9999999px;">\n\t\t\t\t\t<p class="iui-grid-grouping-panel-item-label">Empty Group</p>\n\t\t\t\t\t<span class="iui-grid-grouping-panel-item-button"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class="iui-grid-grouping-panel-item" style="position:absolute;pointer-events:none;" [ngStyle]="{ display: dragGroupSettings.display, top: dragGroupSettings.top + \'px\', left: dragGroupSettings.left + \'px\' }" #dragGroup>\n\t\t\t\t\t<p class="iui-grid-grouping-panel-item-label">{{dragGroupSettings.label}}</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div *ngIf="showHeader" class="iui-grid-block iui-grid-block-top" [ngStyle]="{ left: -contentLeftPos + \'px\', top: groupPanelHeight + \'px\' }" #header>\n\t\t\t\t<table cellpadding="0" cellspacing="0">\n\t\t\t\t\t<tr style="position:relative;" #headerRow>\n\t\t\t\t\t\t<td [ngClass]="column.style.header" *ngFor="let column of scrollColumnList" (mousemove)="columnMouseMove($event, column)" (mousedown)="columnMouseDown($event, column)" (mouseup)="columnMouseUp($event, column)" (mouseenter)="columnMouseEnter($event, column)" (mouseleave)="columnMouseLeave($event, column)" (touchstart)="columnTouchStart($event, column)" [ngStyle]="column.inlineStyle.header" #headerCellElem>\n\t\t\t\t\t\t\t<div [ngStyle]="{ opacity: getColumnOpacity(column), \'text-align\': getColumnAlignment(column.data), width: getColumnWidth(column.data) + \'px\' }">\n\t\t\t\t\t\t\t\t<span *ngIf="isSortingColumn(column.data)" [ngClass]="column.style.sorting" data-element="sort-button"></span>\n\t\t\t\t\t\t\t\t<span [iuiTemplateOutlet]="headerData[0]" [iuiTemplateOutletContext]="{$implicit: (column.data)}"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td *ngIf="reorderColumnObj && !isGroupPanelHovered && isGridHovered" [ngClass]="reorderColumnObj.style.header" [ngStyle]="{ position: \'absolute\', top:0, left: reorderColumnObjPos.left + \'px\', \'pointer-events\': \'none\', \'z-index\': 999 }">\n\t\t\t\t\t\t\t<div [ngStyle]="{ opacity: \'0.5\', \'text-align\': getColumnAlignment(reorderColumnObj.data), width: getColumnWidth(reorderColumnObj.data) + \'px\' }">\n\t\t\t\t\t\t\t\t<span [iuiTemplateOutlet]="headerData[0]" [iuiTemplateOutletContext]="{$implicit: (reorderColumnObj.data)}"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</div>\n\t\t\t<div class="iui-grid-block" [ngStyle]="{ \'margin-top\': blockMarginTop + groupPanelHeight + \'px\', height: blockSize.height + \'px\' }" (scroll)="onContentScroll($event)" #contentBlock>\n\t\t\t\t<table cellpadding="0" cellspacing="0" style="position:absolute;" [ngStyle]="{ left: -contentLeftPos + \'px\' }" #body>\n\t\t\t\t\t<tr [ngClass]="row.style.row" *ngFor="let row of scrollRowList; let i = index" (mouseenter)="rowMouseEnter($event, row)" (mouseleave)="rowMouseLeave($event, row)" (mousedown)="rowMouseDown($event, row)" (mouseup)="rowMouseUp($event, row)" [iuiDraggable]="row.draggable" (dragstart)="rowDragStart($event, row)" (dragover)="rowDragOver($event, row, i)" (drop)="rowDragDrop($event, row)" (click)="rowClickEvent($event, row)" (dblclick)="rowDblClickEvent($event, row)" (touchstart)="rowTouchStart($event, row)" [ngStyle]="row.inlineStyle" #rowElem>\n\t\t\t\t\t\t<td [ngClass]="row.style.cell" *ngFor="let cell of row.cells; let j = index" (mousedown)="cellMouseDown($event, cell)" [ngStyle]="cell.inlineStyle" #rowCellElem>\n\t\t\t\t\t\t\t<div [ngClass]="cell.style.content" [ngStyle]="{ \'padding-left\': cell.indent + \'px\', \'text-align\': cell.align, width: cell.width + \'px\', height: cell.height }" tabindex="{{cell.tabIndex}}" [iuiFocus]="cell.data == this.currentFocusCell" (focus)="cellGotFocus(cell)" (blur)="cellLostFocus(cell)" (keydown)="cellKeyDown($event, cell)" (keypress)="cellKeyPress($event, cell)" (keyup)="cellKeyUp($event, cell)">\n\t\t\t\t\t\t\t\t<span *ngIf="cell.expandBoxAllowed" [ngClass]="row.style.expandBox" (mousedown)="expandBoxMouseDown($event, row.data)" (mouseup)="expandBoxMouseUp($event, row.data)" (touchstart)="expandBoxTouchStart($event, row.data)"></span>\n\t\t\t\t\t\t\t\t<span [iuiTemplateOutlet]="cellData[0]" [iuiTemplateOutletContext]="{$implicit: (cell.data)}"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td> \n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</div>\n\t\t\t<div *ngIf="showFooter" class="iui-grid-block iui-grid-block-bottom" [ngStyle]="{ left: -contentLeftPos + \'px\', bottom: getFooterBottomPos() + \'px\' }" #footer>\n\t\t\t\t<table cellpadding="0" cellspacing="0">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td [ngClass]="column.style.footer" *ngFor="let column of scrollColumnList" [ngStyle]="column.inlineStyle.footer" #footerCellElem>\n\t\t\t\t\t\t\t<div [ngStyle]="{ \'text-align\': getColumnAlignment(column.data, true), width: getColumnWidth(column.data) + \'px\' }">\n\t\t\t\t\t\t\t\t<span [iuiTemplateOutlet]="footerData[0]" [iuiTemplateOutletContext]="{$implicit: (column.data)}"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td> \n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</div>\n            <iui-scrollbar *ngIf="isVerScrollVisible()" [enabled]="enabled" [value]="currentScrollPos.y" [max]="maxScrollPos.y" [largeChange]="scrollLargeChange.y" [height]="scrollBarSize.height" (valueChanged)="onVerticalScrollChanged($event)" (scrollStart)="onVerticalScrollStart($event)" (scrollEnd)="onVerticalScrollEnd($event)" [position]="{ top: groupPanelHeight + 1 }" #verScroll></iui-scrollbar>\n            <iui-scrollbar *ngIf="isHorScrollVisible()" [enabled]="enabled" [orientation]="horScrollOrientation" [value]="currentScrollPos.x" [max]="maxScrollPos.x" [width]="scrollBarSize.width" (valueChanged)="onHorizontalScrollChanged($event)" (scrollStart)="onHorizontalScrollStart($event)" (scrollEnd)="onHorizontalScrollEnd($event)" [position]="{ bottom: horScrollElemPos.bottom }" #horScroll></iui-scrollbar>\n            <div *ngIf="isVerScrollVisible() && isHorScrollVisible()" style="background:#f5f5f5;position:absolute;right:0;bottom:0;width:16px;height:16px;" [ngStyle]="{ bottom: cornerScrollElemPos.bottom + \'px\' }"></div>\n            <iui-paginator *ngIf="isPaginationEnabled()" align="center" style="position:absolute;top:0;width:100%" [ngStyle]="{ top: paginatorPos.top + \'px\' }" [maxPages]="getMaxPages()" [currentPage]="currentPageNumber" (pageChanged)="paginatorPageChanged($event)" #paginator></iui-paginator>\n\t\t</div>\n\t',
inputs:"allowColumnReorder allowDrag allowDrop allowFilter allowFocus appRef autoSizeColumns autoUpdate columns controlStyle data dataFields enabled focusedCell gridLines name rowHeight rows paging selectedColumn selectedRow selectionMode showScroll sorting state".split(" "),outputs:"afterSelect beforeEdit beforeSelect beforeUpdate change columnAdding columnAdded columnClick columnRemoving columnRemoved columnsCleared columnOrderChanged columnSizeChanged dragEnter dragDrop dragLeave dragOver keyDown keyPress keyUp loadComplete rowAdding rowAdded rowClick rowDblClick rowRemoving rowRemoved rowsCleared scrollPosChanged selectionChanged updateComplete".split(" "),
providers:[integralui_core_1.IntegralUIBaseService,integralui_data_service_1.IntegralUIDataService],encapsulation:core_1.ViewEncapsulation.None}),__metadata("design:paramtypes",[integralui_data_service_1.IntegralUIDataService,integralui_dragdrop_service_1.IntegralUIDragDropService,core_1.ElementRef,core_1.Renderer,integralui_common_service_1.IntegralUICommonService,integralui_filter_service_1.IntegralUIFilterService,core_1.ComponentFactoryResolver,integralui_core_1.IntegralUIBaseService])],IntegralUIGrid);
exports.IntegralUIGrid=IntegralUIGrid;