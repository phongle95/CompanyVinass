/*
  filename: integralui.treelist.js
  version : 1.4.0
  Copyright Â© 2016-2018 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(e,a){function c(){this.constructor=e}for(var b in a)a.hasOwnProperty(b)&&(e[b]=a[b]);e.prototype=null===a?Object.create(a):(c.prototype=a.prototype,new c)},__decorate=this&&this.__decorate||function(e,a,c,b){var g=arguments.length,f=3>g?a:null===b?b=Object.getOwnPropertyDescriptor(a,c):b,h;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)f=Reflect.decorate(e,a,c,b);else for(var d=e.length-1;0<=d;d--)if(h=e[d])f=(3>g?h(f):3<g?h(a,c,f):
h(a,c))||f;return 3<g&&f&&Object.defineProperty(a,c,f),f},__metadata=this&&this.__metadata||function(e,a){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,a)},core_1=require("@angular/core"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),integralui_data_service_1=require("../services/integralui.data.service"),IntegralUITreeListItem=function(e){function a(c,b,g){var a=e.call(this,
c,b)||this;a.elemRef=c;a.commonService=b;a.baseService=g;a.templateData=[];a.parentCtrl=null;return a}__extends(a,e);a.prototype.ngOnInit=function(){this.templateData.push(this.data);this.parentCtrl=this.baseService.getComponent();this.generalClassName="iui-treelistitem";this.contentClassName=this.generalClassName+"-content";this.initStyle()};return a}(integralui_core_1.IntegralUIItem);__decorate([core_1.Input(),__metadata("design:type",Object)],IntegralUITreeListItem.prototype,"templateRef",void 0);
IntegralUITreeListItem=__decorate([core_1.Component({selector:"iui-treelistitem",template:'\n\t\t<li [ngClass]="getControlClass()" (click)="onClick($event)" (mousedown)="onMouseDown($event)" (mouseup)="onMouseUp($event)" (mouseenter)="onMouseEnter($event)" (mousemove)="onMouseMove($event)" (mouseleave)="onMouseLeave($event)">\n\t\t\t<ng-template ngFor [ngForOf]="templateData" [ngForTemplate]="templateRef"></ng-template>  \n\t\t</li>\n\t',inputs:"controlStyle data enabled icon name state text".split(" "),
outputs:"click mouseDown mouseEnter mouseLeave mouseMove mouseUp".split(" "),encapsulation:core_1.ViewEncapsulation.None}),__metadata("design:paramtypes",[core_1.ElementRef,integralui_common_service_1.IntegralUICommonService,integralui_core_1.IntegralUIBaseService])],IntegralUITreeListItem);exports.IntegralUITreeListItem=IntegralUITreeListItem;
var IntegralUITreeList=function(e){function a(c,b,g,a,h){var d=e.call(this,g)||this;d.dataService=c;d.elemRef=b;d.commonService=g;d.cmpResolver=a;d.baseService=h;d.animSpeed=300;d.prevData=null;d.itemData=null;d.nextData=null;d.hoverItem=null;d.blockPos={top:30,left:0};d.leftBlockPos={top:30,left:-300};d.rightBlockPos={top:30,left:300};d.leftBlockWidth=0;d.blockWidth=0;d.rightBlockWidth=0;d.leftBlockOpacity=0;d.blockOpacity=1;d.rightBlockOpacity=0;d.elemSize={width:0,height:0};d.currentSelection=
null;d.headerItem=null;d.headerText="";d.trialRef=null;d.afterSelect=new core_1.EventEmitter;d.beforeSelect=new core_1.EventEmitter;d.clear=new core_1.EventEmitter;d.itemAdding=new core_1.EventEmitter;d.itemAdded=new core_1.EventEmitter;d.itemRemoving=new core_1.EventEmitter;d.itemRemoved=new core_1.EventEmitter;d.selectionChanged=new core_1.EventEmitter;d.selList=[];return d}__extends(a,e);Object.defineProperty(a.prototype,"selectedItem",{get:function(){return this.currentSelection},set:function(c){var b=
{cancel:!1,header:this.headerItem,item:c};this.beforeSelect.emit(b);1!=b.cancel&&this.currentSelection!=c&&(this.currentSelection=c,c?c.items&&0<c.items.length&&(this.headerItem=c,this.headerText=c.text):(this.headerItem=null,this.headerText=this.title),this.afterSelect.emit({header:this.headerItem,item:c}),this.selectionChanged.emit(null))},enumerable:!0,configurable:!0});a.prototype.ngOnInit=function(){this.baseService.setComponent(this);this.dataService.init([{data:this.items}]);this.itemData=
this.items;this.headerText=this.title;this.generalClassName="iui-treelist";this.initStyle()};a.prototype.ngAfterViewInit=function(){var c=this;c.blockPos.top=this.headerElem.nativeElement.offsetHeight;c.leftBlockPos.top=this.headerElem.nativeElement.offsetHeight;c.rightBlockPos.top=this.headerElem.nativeElement.offsetHeight;c.elemSize={width:c.elemRef.nativeElement.firstElementChild.clientWidth,height:c.elemRef.nativeElement.firstElementChild.clientHeight};c.leftBlockWidth=c.blockWidth=c.rightBlockWidth=
c.elemSize.width;var b=setTimeout(function(){var a=c.cmpResolver.resolveComponentFactory(integralui_core_1.IntegralUITComponent);a&&c.contentRef&&(c.trialRef=c.contentRef.createComponent(a));clearTimeout(b)},100)};a.prototype.ngOnDestroy=function(){this.trialRef&&this.trialRef.destroy()};a.prototype.onItemMouseEnter=function(c,b){this.isEnabled&&(this.hoverItem=b)};a.prototype.onItemMouseLeave=function(c,b){this.hoverItem=null};a.prototype.onItemMouseDown=function(c,b){if(this.isEnabled&&1==c.buttons&&
b){var a=this;if(b.items&&0<b.items.length){a.selList.push(a.headerItem);a.nextData=b.items;var f=0,e=5/a.elemSize.width,d=.5,l=1/a.elemSize.width,k=0,m=setInterval(function(){f<a.elemSize.width?(f+=10,d-=e,k+=l,a.blockPos.left=-f,a.blockOpacity=d,a.rightBlockPos.left=a.elemSize.width-f,a.rightBlockOpacity=k):(a.selectedItem=b,a.itemData=a.nextData,a.blockPos.left=0,a.blockOpacity=1,a.rightBlockPos.left=a.elemSize.width,a.rightBlockOpacity=0,clearInterval(m))},10)}else a.selectedItem=b}};a.prototype.onHeaderMouseDown=
function(a){var b=this;if(this.isEnabled&&1==a.buttons&&0<b.selList.length){var c=b.selList.length-1;b.prevData=b.selList[c]&&b.selList[c].items?b.selList[c].items:b.items;var f=0,e=5/b.elemSize.width,d=.5,l=1/b.elemSize.width,k=0,m=setInterval(function(){f<b.elemSize.width?(f+=10,d-=e,k+=l,b.blockPos.left=f,b.blockOpacity=d,b.leftBlockPos.left=f-b.elemSize.width,b.leftBlockOpacity=k):(b.selectedItem=b.selList[c],b.itemData=b.prevData,b.selList.splice(c,1),b.blockPos.left=0,b.blockOpacity=1,b.leftBlockPos.left=
-b.elemSize.width,b.leftBlockOpacity=0,clearInterval(m))},10)}};a.prototype.getItemState=function(a){return a==this.selectedItem?integralui_core_1.IntegralUIObjectState.selected:a==this.hoverItem?integralui_core_1.IntegralUIObjectState.hovered:integralui_core_1.IntegralUIObjectState.normal};return a}(integralui_core_1.IntegralUIBaseComponent);__decorate([core_1.ViewChildren(IntegralUITreeListItem),__metadata("design:type",core_1.QueryList)],IntegralUITreeList.prototype,"contentList",void 0);
__decorate([core_1.ViewChild("contentBlock",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],IntegralUITreeList.prototype,"contentRef",void 0);__decorate([core_1.ViewChild("header",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUITreeList.prototype,"headerElem",void 0);__decorate([core_1.ViewChild("leftBlock",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUITreeList.prototype,"leftBlockElem",void 0);
__decorate([core_1.ViewChild("contentBlock",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUITreeList.prototype,"blockElem",void 0);__decorate([core_1.ViewChild("rightBlock",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUITreeList.prototype,"rightBlockElem",void 0);__decorate([core_1.ContentChild(core_1.TemplateRef),__metadata("design:type",Object)],IntegralUITreeList.prototype,"itemTemplate",void 0);
__decorate([core_1.Input(),__metadata("design:type",Array)],IntegralUITreeList.prototype,"items",void 0);__decorate([core_1.Input(),__metadata("design:type",String)],IntegralUITreeList.prototype,"title",void 0);__decorate([core_1.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],IntegralUITreeList.prototype,"selectedItem",null);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUITreeList.prototype,"afterSelect",void 0);
__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUITreeList.prototype,"beforeSelect",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUITreeList.prototype,"clear",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUITreeList.prototype,"itemAdding",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUITreeList.prototype,"itemAdded",void 0);
__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUITreeList.prototype,"itemRemoving",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUITreeList.prototype,"itemRemoved",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUITreeList.prototype,"selectionChanged",void 0);
IntegralUITreeList=__decorate([core_1.Component({selector:"iui-treelist",template:'\n\t\t<div [ngClass]="getControlClass()">\n\t\t\t<div class="iui-treelist-header" (mousedown)="onHeaderMouseDown($event)" #header>\n                <span class="expand-icons back" *ngIf="headerItem!=null"></span>\n                <span>{{headerText}}</span>\n\t\t\t</div>\n\t\t\t<ul class="iui-treelist-block" #leftBlock [ngStyle]="{ \'position\': \'absolute\', \'top\': leftBlockPos.top + \'px\', \'left\': leftBlockPos.left + \'px\', \'width\': leftBlockWidth + \'px\', \'opacity\': leftBlockOpacity }">\n\t            <iui-treelistitem *ngFor="let item of prevData" [enabled]="item.enabled" [text]="item.text" [templateRef]="itemTemplate" [data]="item">\n\t\t\t\t</iui-treelistitem> \n\t\t\t</ul>\n\t\t\t<ul class="iui-treelist-block" #contentBlock [ngStyle]="{ \'position\': \'absolute\', \'top\': blockPos.top + \'px\', \'left\': blockPos.left + \'px\', \'width\': blockWidth + \'px\', \'opacity\': blockOpacity }">\n\t            <iui-treelistitem *ngFor="let item of itemData" [enabled]="item.enabled" [text]="item.text" [templateRef]="itemTemplate" [data]="item" (mouseDown)="onItemMouseDown($event, item)" (mouseEnter)="onItemMouseEnter($event, item)" (mouseLeave)="onItemMouseLeave($event, item)" [state]="getItemState(item)">\n\t\t\t\t</iui-treelistitem> \n\t\t\t</ul>\n\t\t\t<ul class="iui-treelist-block" #rightBlock [ngStyle]="{ \'position\': \'absolute\', \'top\': rightBlockPos.top + \'px\', \'left\': rightBlockPos.left + \'px\', \'width\': rightBlockWidth + \'px\', \'opacity\': rightBlockOpacity }">\n\t            <iui-treelistitem *ngFor="let item of nextData" [enabled]="item.enabled" [text]="item.text" [templateRef]="itemTemplate" [data]="item">\n\t\t\t\t</iui-treelistitem> \n\t\t\t</ul>\n\t\t</div>\n\t',inputs:["controlStyle",
"data","enabled","state"],providers:[integralui_core_1.IntegralUIBaseService,integralui_data_service_1.IntegralUIDataService]}),__metadata("design:paramtypes",[integralui_data_service_1.IntegralUIDataService,core_1.ElementRef,integralui_common_service_1.IntegralUICommonService,core_1.ComponentFactoryResolver,integralui_core_1.IntegralUIBaseService])],IntegralUITreeList);exports.IntegralUITreeList=IntegralUITreeList;