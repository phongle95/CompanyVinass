/*
  filename: integralui.dropdownbutton.js
  version : 1.0.0
  Copyright Â© 2016-2018 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(f,b){function a(){this.constructor=f}for(var c in b)b.hasOwnProperty(c)&&(f[c]=b[c]);f.prototype=null===b?Object.create(b):(a.prototype=b.prototype,new a)},__decorate=this&&this.__decorate||function(f,b,a,c){var e=arguments.length,d=3>e?b:null===c?c=Object.getOwnPropertyDescriptor(b,a):c,g;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)d=Reflect.decorate(f,b,a,c);else for(var h=f.length-1;0<=h;h--)if(g=f[h])d=(3>e?g(d):3<e?g(b,a,d):
g(b,a))||d;return 3<e&&d&&Object.defineProperty(b,a,d),d},__metadata=this&&this.__metadata||function(f,b){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(f,b)},core_1=require("@angular/core"),integralui_button_1=require("./integralui.button"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),IntegralUIDropDownButton=function(f){function b(a,c){var b=f.call(this,a,c)||this;b.elemRef=
a;b.commonService=c;b.originalDropDownSettings={};b.dropDownSettings={};b.placementValue=integralui_core_1.IntegralUIPlacement.Right;b.openDirection=integralui_core_1.IntegralUIDirection.Below;b.buttonClass=[];b.itemClick=new core_1.EventEmitter;b.dropDownOpening=new core_1.EventEmitter;b.dropDownOpened=new core_1.EventEmitter;b.dropDownClosed=new core_1.EventEmitter;b.updateDropDownSettings();return b}__extends(b,f);b.prototype.ngOnInit=function(){this.generalClassName="iui-dropdown-button";this.buttonClassName=
this.generalClassName+"-btn";this.initStyle()};b.prototype.initStyle=function(){this.defaultStyle={general:{disabled:this.generalClassName+"-disabled",focused:this.generalClassName+"-focused",normal:this.generalClassName,hovered:this.generalClassName+"-hovered",selected:this.generalClassName+"-selected"},button:{disabled:this.buttonClassName+"-disabled",focused:this.buttonClassName+"-focused",normal:this.buttonClassName,hovered:this.buttonClassName+"-hovered",selected:this.buttonClassName+"-selected"}};
this.updateStyle(this.controlStyle);this.updateControlClass();this.updateButtonClass()};b.prototype.ngAfterViewInit=function(){};Object.defineProperty(b.prototype,"placement",{get:function(){return this.placementValue},set:function(a){this.placementValue=a;this.updateAdjustment();this.refresh()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"direction",{get:function(){return this.openDirection},set:function(a){this.openDirection=a;this.updateAdjustment();this.refresh()},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"settings",{get:function(){return this.dropDownSettings},set:function(a){this.updateDropDownSettings(a)},enumerable:!0,configurable:!0});b.prototype.getAdjustmentValue=function(a){var c={top:0,right:0,bottom:0,left:0};a&&(c={top:this.commonService.isFieldAvailable(a.top,0),bottom:this.commonService.isFieldAvailable(a.bottom,0),right:this.commonService.isFieldAvailable(a.right,0),left:this.commonService.isFieldAvailable(a.left,0)});return c};b.prototype.updateDropDownSettings=
function(a){var c=this,b=setTimeout(function(){c.originalDropDownSettings=a?{adjustment:c.getAdjustmentValue(a.adjustment),appRef:c.commonService.isFieldAvailable(a.appRef,null),autoClose:c.commonService.isFieldAvailable(a.autoClose,!0),direction:c.openDirection,enabled:c.commonService.isFieldAvailable(a.enabled,!0),inverse:!1,items:c.commonService.isFieldAvailable(a.items,[]),position:"manual",style:c.commonService.isFieldAvailable(a.style,c.getDefaultDropDownStyle())}:{adjustment:c.getAdjustmentValue(),
appRef:null,autoClose:!0,direction:c.openDirection,enabled:!0,inverse:!1,items:[],position:"manual",style:c.getDefaultDropDownStyle()};c.dropDownSettings={adjustment:c.originalDropDownSettings.adjustment,appRef:c.originalDropDownSettings.appRef,autoClose:c.originalDropDownSettings.autoClose,direction:c.originalDropDownSettings.direction,enabled:c.originalDropDownSettings.enabled,inverse:c.originalDropDownSettings.inverse,items:c.originalDropDownSettings.items,position:c.originalDropDownSettings.position,
style:c.originalDropDownSettings.style};c.updateAdjustment();clearTimeout(b)},1)};b.prototype.updateAdjustment=function(){var a={top:0,right:0,bottom:0,left:0};this.originalDropDownSettings&&this.originalDropDownSettings.adjustment&&(a={top:this.originalDropDownSettings.adjustment.top,right:this.originalDropDownSettings.adjustment.right,bottom:this.originalDropDownSettings.adjustment.bottom,left:this.originalDropDownSettings.adjustment.left});if(this.elemRef&&this.buttonElem){var b=this.commonService.getBorderWidth(this.elemRef.nativeElement.firstElementChild),
e=this.commonService.getMargin(this.elemRef.nativeElement.firstElementChild),d=this.commonService.getPadding(this.elemRef.nativeElement.firstElementChild);this.placementValue==integralui_core_1.IntegralUIPlacement.Left?this.openDirection&integralui_core_1.IntegralUIDirection.Left?(a.left=a.left-this.buttonElem.nativeElement.offsetWidth-(e.left+b.left+d.left)+1,this.openDirection&integralui_core_1.IntegralUIDirection.Below?a.top=a.top-this.buttonElem.nativeElement.offsetHeight-(e.top+b.top+b.bottom+
d.top+d.bottom)+1:this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(a.top+=1)):(this.openDirection&integralui_core_1.IntegralUIDirection.Right&&(a.left=a.left-this.buttonElem.nativeElement.offsetWidth-(e.left+b.left+d.left)),this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(a.top=a.top-this.buttonElem.nativeElement.offsetHeight-(e.top+b.top+b.bottom+d.top+d.bottom)+2)):this.openDirection&integralui_core_1.IntegralUIDirection.Right?(a.left+=e.right+b.right+d.right,this.openDirection&
integralui_core_1.IntegralUIDirection.Below?a.top=a.top-this.buttonElem.nativeElement.offsetHeight-(e.top+b.top+b.bottom+d.top+d.bottom)+1:this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(a.top+=1)):(a.left=this.openDirection&integralui_core_1.IntegralUIDirection.Left?a.left+(e.right+b.right+d.right):a.left-this.buttonElem.nativeElement.offsetWidth,this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(a.top=a.top-this.buttonElem.nativeElement.offsetHeight-(e.top+b.top+b.bottom+
d.top+d.bottom)+2))}this.dropDownSettings&&(this.dropDownSettings.adjustment=a,this.dropDownSettings.direction=this.openDirection,this.dropDownSettings.inverse=this.placementValue!=integralui_core_1.IntegralUIPlacement.Left||this.openDirection&integralui_core_1.IntegralUIDirection.Right||!(this.openDirection&integralui_core_1.IntegralUIDirection.Above||this.openDirection&integralui_core_1.IntegralUIDirection.Below)?!1:!0)};b.prototype.onDropDownItemClick=function(a){this.itemClick.emit(a)};b.prototype.onDropDownOpening=
function(a){this.dropDownOpening.emit(a)};b.prototype.onDropDownOpened=function(a){this.dropDownOpened.emit(a)};b.prototype.onDropDownClosed=function(a){this.dropDownClosed.emit(a)};b.prototype.getDefaultDropDownStyle=function(){return{general:{normal:"iui-dropdown-button-list"}}};b.prototype.updateButtonClass=function(){this.buttonClass.length=0;this.placementValue==integralui_core_1.IntegralUIPlacement.Left?(this.buttonClass.push(this.buttonClassName+"-left"),this.openDirection&integralui_core_1.IntegralUIDirection.Left?
this.buttonClass.push(this.generalClassName+"-open-left"):this.openDirection&integralui_core_1.IntegralUIDirection.Above&&this.buttonClass.push(this.generalClassName+"-open-above")):(this.buttonClass.push(this.buttonClassName+"-right"),this.openDirection&integralui_core_1.IntegralUIDirection.Right?this.buttonClass.push(this.generalClassName+"-open-right"):this.openDirection&integralui_core_1.IntegralUIDirection.Above&&this.buttonClass.push(this.generalClassName+"-open-above"));this.options.currentStyle&&
(this.buttonClass.push(this.options.currentStyle.button.normal),this.state&integralui_core_1.IntegralUIObjectState.disabled?this.buttonClass.push(this.options.currentStyle.button.disabled):this.state&integralui_core_1.IntegralUIObjectState.focused?this.buttonClass.push(this.options.currentStyle.button.focused):this.state&integralui_core_1.IntegralUIObjectState.selected?this.buttonClass.push(this.options.currentStyle.button.selected):this.state&integralui_core_1.IntegralUIObjectState.hovered&&this.buttonClass.push(this.options.currentStyle.button.hovered))};
b.prototype.getButtonClass=function(){return this.buttonClass};b.prototype.getButtonStyle=function(a){return this.commonService.isString(a)?a:a?{disabled:this.commonService.isFieldAvailable(a.disabled,this.buttonClassName+"-disabled"),focused:this.commonService.isFieldAvailable(a.focused,this.buttonClassName+"-focused"),hovered:this.commonService.isFieldAvailable(a.hovered,this.buttonClassName+"-hovered"),normal:this.commonService.isFieldAvailable(a.normal,this.buttonClassName),selected:this.commonService.isFieldAvailable(a.selected,
this.buttonClassName+"-selected")}:{disabled:this.defaultStyle.button.disabled,focused:this.defaultStyle.button.focused,hovered:this.defaultStyle.button.hovered,normal:this.defaultStyle.button.normal,selected:this.defaultStyle.button.selected}};b.prototype.updateStyle=function(a){this.options.currentStyle=a?{general:this.getGeneralStyle(a.general),button:this.getButtonStyle(a.button)}:{general:{disabled:this.defaultStyle.general.disabled,focused:this.defaultStyle.general.focused,hovered:this.defaultStyle.general.hovered,
normal:this.defaultStyle.general.normal,selected:this.defaultStyle.general.selected},button:{disabled:this.defaultStyle.button.disabled,focused:this.defaultStyle.button.focused,hovered:this.defaultStyle.button.hovered,normal:this.defaultStyle.button.normal,selected:this.defaultStyle.button.selected}}};b.prototype.refresh=function(){var a=this,b=setTimeout(function(){a.updateStyle(this.controlStyle);a.updateControlClass();a.updateButtonClass();clearTimeout(b)},1)};return b}(integralui_button_1.IntegralUIButton);
__decorate([core_1.ViewChild("button"),__metadata("design:type",core_1.ElementRef)],IntegralUIDropDownButton.prototype,"buttonElem",void 0);__decorate([core_1.Input(),__metadata("design:type",Number),__metadata("design:paramtypes",[Number])],IntegralUIDropDownButton.prototype,"placement",null);__decorate([core_1.Input(),__metadata("design:type",Number),__metadata("design:paramtypes",[Number])],IntegralUIDropDownButton.prototype,"direction",null);
__decorate([core_1.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],IntegralUIDropDownButton.prototype,"settings",null);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIDropDownButton.prototype,"itemClick",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIDropDownButton.prototype,"dropDownOpening",void 0);
__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIDropDownButton.prototype,"dropDownOpened",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIDropDownButton.prototype,"dropDownClosed",void 0);
IntegralUIDropDownButton=__decorate([core_1.Component({selector:"iui-dropdown-button",template:'\n\t\t<div [ngClass]="getControlClass()">\n\t\t\t<ng-content></ng-content>\n\t\t\t<div [ngClass]="getButtonClass()" [iuiContextMenu]="settings" (menuClick)="onDropDownItemClick($event)" (menuOpening)="onDropDownOpening($event)" (menuOpened)="onDropDownOpened($event)" (menuClosed)="onDropDownClosed($event)" #button>\n\t\t\t\t<span></span>\n\t\t\t</div>\n\t\t</div>\n\t',inputs:["controlStyle","data","enabled",
"name","state"],encapsulation:core_1.ViewEncapsulation.None}),__metadata("design:paramtypes",[core_1.ElementRef,integralui_common_service_1.IntegralUICommonService])],IntegralUIDropDownButton);exports.IntegralUIDropDownButton=IntegralUIDropDownButton;